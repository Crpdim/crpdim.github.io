{
    "version": "https://jsonfeed.org/version/1",
    "title": "Carpe diem",
    "subtitle": "採擷今日!",
    "icon": "https://crpdim.github.io/images/favicon.ico",
    "description": "A good boy!",
    "home_page_url": "https://crpdim.github.io",
    "items": [
        {
            "id": "https://crpdim.github.io/ai/deep-learning/pytorch02/",
            "url": "https://crpdim.github.io/ai/deep-learning/pytorch02/",
            "title": "从零实现线性回归",
            "date_published": "2023-06-17T16:00:00.000Z",
            "content_html": "<h1 id=\"从零实现线性回归\"><a class=\"anchor\" href=\"#从零实现线性回归\">#</a> 从零实现线性回归</h1>\n<details class=\"info\"><summary>阅读提示</summary><div>\n<p>本文包含两部分：先从 “线性回归的概念与训练目标” 出发，再用 PyTorch 分别演示 “从零实现（手写 SGD、损失函数、数据迭代器）” 与 “用  <code>nn.Linear</code>  的简洁实现”。建议边看边跑代码，并在每个阶段打印 loss 与参数误差，建立直觉。</p>\n</div></details>\n<blockquote>\n<p>在尝试囫囵吞枣学习深度学习后，我深切地认识到了自己的浮躁：耗费了不少时间，却只学到寥寥无几的零散知识。</p>\n</blockquote>\n<h2 id=\"回归regression\"><a class=\"anchor\" href=\"#回归regression\">#</a> 回归（Regression）</h2>\n<p>回归是研究一组随机变量 (Y_1, Y_2, \\dots, Y_i) 与另一组变量 (X_1, X_2, \\dots, X_k) 之间关系的统计分析方法。它用于为一个或多个自变量与因变量之间的关系建模。在自然科学和社会科学领域，回归常用来刻画输入与输出的关系；当我们需要预测<strong>连续数值</strong>时，通常就会遇到回归问题。</p>\n<h2 id=\"线性回归\"><a class=\"anchor\" href=\"#线性回归\">#</a> 线性回归</h2>\n<p>线性回归基于几个简单假设：</p>\n<ul>\n<li>自变量与因变量的关系是线性的，即因变量 (y) 可以表示为自变量 (x) 中元素的加权和（通常包含观测噪声）。</li>\n<li>噪声相对 “正常”，一般假设服从正态分布。</li>\n</ul>\n<p>书中举的经典例子是房价预测：根据房龄与房间面积估算房屋价值。我们需要收集真实数据集（训练集）。训练集中每行数据称为<strong>样本</strong>（数据点），如房屋属性（房龄、面积）。预测目标（房价）称为<strong>标签（label）/ 目标（target）</strong>，自变量（房龄、面积）称为<strong>特征（feature）</strong>。</p>\n<p>线性假设是指目标（房价）可以表示为特征（面积与房龄）的加权和：</p>\n<p><strong>price = w_area · area + w_age · age + b</strong></p>\n<p>其中 (w) 是权重，决定每个特征对预测值的影响；(b) 称为偏置（bias）或截距，当特征全为 0 时决定预测值基线。</p>\n<p>给定训练数据特征 <strong>X</strong> 和对应标签 <strong>y</strong>，线性回归的目标是找到权重向量 <strong>w</strong> 与偏置 (b)。在寻找最好的模型参数之前，还需要两个要素：</p>\n<ul>\n<li>一种模型质量的度量方式（损失函数）</li>\n<li>一种更新模型以提高预测质量的方法（模型优化）</li>\n</ul>\n<h2 id=\"损失函数\"><a class=\"anchor\" href=\"#损失函数\">#</a> 损失函数</h2>\n<blockquote>\n<p>损失函数（loss function）能够量化目标的实际值与预测值之间的差距。通常选择非负数作为损失，数值越小表示预测越好；完美预测时损失为 0。回归问题中常用平方误差作为损失。</p>\n</blockquote>\n<p>单个样本的平方误差（除以 2 便于求导）可写为 (\\frac<ruby 2=\"\">(y\\_hat - y)<rp>(</rp><rt>2</rt><rp>)</rp></ruby>)。度量整个训练集质量时，通常计算 (n) 个样本损失的均值。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">squared_loss</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\"># y_hat：预测值</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>y_hat <span class=\"token operator\">-</span> y<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><h2 id=\"模型优化\"><a class=\"anchor\" href=\"#模型优化\">#</a> 模型优化</h2>\n<p>解析解：线性回归有解析解（可用公式直接算出最优解），但并不是所有问题都存在解析解。解析解便于数学分析，但限制严格，无法覆盖深度学习里大量模型。</p>\n<p>在无法得到解析解的情况下，仍然可以有效训练模型。书中使用的是梯度下降（尤其是小批量随机梯度下降 SGD），几乎可以优化绝大多数深度学习模型。</p>\n<p>基本步骤：</p>\n<ul>\n<li>初始化模型参数（如随机初始化）</li>\n<li>从数据集中随机抽取小批量样本</li>\n<li>沿负梯度方向更新参数，重复迭代</li>\n</ul>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">sgd</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">,</span> lr<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">with</span> torch<span class=\"token punctuation\">.</span>no_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            param <span class=\"token operator\">-=</span> lr <span class=\"token operator\">*</span> param<span class=\"token punctuation\">.</span>grad <span class=\"token operator\">/</span> batch_size</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            param<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">.</span>zero_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"线性回归从零开始实现\"><a class=\"anchor\" href=\"#线性回归从零开始实现\">#</a> 线性回归从零开始实现</h2>\n<h3 id=\"数据集生成\"><a class=\"anchor\" href=\"#数据集生成\">#</a> 数据集生成</h3>\n<p>构造人造数据集（合成数据）：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> random</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">syn</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> num_examples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    x <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>num_examples<span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 特征：均值 0 方差 1</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    y <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b                           <span class=\"token comment\"># 真实标签</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    y <span class=\"token operator\">+=</span> torch<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>                  <span class=\"token comment\"># 加入噪声</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">return</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>true_w <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>tensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>true_b <span class=\"token operator\">=</span> <span class=\"token number\">4.2</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>features<span class=\"token punctuation\">,</span> labels <span class=\"token operator\">=</span> syn<span class=\"token punctuation\">(</span>true_w<span class=\"token punctuation\">,</span> true_b<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"读取数据集\"><a class=\"anchor\" href=\"#读取数据集\">#</a> 读取数据集</h3>\n<p>批量读取样本（手写 DataLoader）：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">data_iter</span><span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    num_examples <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    indices <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_examples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    random<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>indices<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> num_examples<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        batch_indices <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>tensor<span class=\"token punctuation\">(</span>indices<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> batch_size<span class=\"token punctuation\">,</span> num_examples<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">yield</span> features<span class=\"token punctuation\">[</span>batch_indices<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">[</span>batch_indices<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h3 id=\"初始化模型参数\"><a class=\"anchor\" href=\"#初始化模型参数\">#</a> 初始化模型参数</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>w <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> requires_grad<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>b <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> requires_grad<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"定义模型\"><a class=\"anchor\" href=\"#定义模型\">#</a> 定义模型</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">linreg</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> torch<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b</pre></td></tr></table></figure><h3 id=\"定义损失函数\"><a class=\"anchor\" href=\"#定义损失函数\">#</a> 定义损失函数</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">squared_loss</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>y_hat <span class=\"token operator\">-</span> y<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><h3 id=\"定义优化算法\"><a class=\"anchor\" href=\"#定义优化算法\">#</a> 定义优化算法</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">sgd</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">,</span> lr<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">with</span> torch<span class=\"token punctuation\">.</span>no_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">for</span> param <span class=\"token keyword\">in</span> params<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            param <span class=\"token operator\">-=</span> lr <span class=\"token operator\">*</span> param<span class=\"token punctuation\">.</span>grad <span class=\"token operator\">/</span> batch_size</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            param<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">.</span>zero_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"开始训练\"><a class=\"anchor\" href=\"#开始训练\">#</a> 开始训练</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>lr <span class=\"token operator\">=</span> <span class=\"token number\">0.03</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>num_epochs <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>net <span class=\"token operator\">=</span> linreg</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>loss <span class=\"token operator\">=</span> squared_loss</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>batch_size <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_epochs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> data_iter<span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">,</span> features<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        l <span class=\"token operator\">=</span> loss<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        l<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        sgd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> lr<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">with</span> torch<span class=\"token punctuation\">.</span>no_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        train_l <span class=\"token operator\">=</span> loss<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> w<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"epoch </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>epoch <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">, loss </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>train_l<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"w 的估计误差: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>true_w <span class=\"token operator\">-</span> w<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>true_w<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"b 的估计误差: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>true_b <span class=\"token operator\">-</span> b<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>可以看到，训练得到的参数与真实参数已经非常接近。</p>\n<h2 id=\"利用-pytorch-简洁实现\"><a class=\"anchor\" href=\"#利用-pytorch-简洁实现\">#</a> 利用 PyTorch 简洁实现</h2>\n<p>利用 PyTorch 提供的  <code>nn.Linear</code>  来实现线性回归：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> torch<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> data</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> torch <span class=\"token keyword\">import</span> nn</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>true_w <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>tensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>true_b <span class=\"token operator\">=</span> <span class=\"token number\">4.2</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>features<span class=\"token punctuation\">,</span> labels <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>synthetic_data<span class=\"token punctuation\">(</span>true_w<span class=\"token punctuation\">,</span> true_b<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">load_array</span><span class=\"token punctuation\">(</span>data_arrays<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">,</span> is_train<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    dataset <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>TensorDataset<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>data_arrays<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span>is_train<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>batch_size <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>data_iter <span class=\"token operator\">=</span> load_array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>net <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>net<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>weight<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>normal_<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>net<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>bias<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>fill_<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>loss <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>MSELoss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>trainer <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>optim<span class=\"token punctuation\">.</span>SGD<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">.</span>parameters<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lr<span class=\"token operator\">=</span><span class=\"token number\">0.03</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>num_epochs <span class=\"token operator\">=</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_epochs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> data_iter<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        l <span class=\"token operator\">=</span> loss<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        trainer<span class=\"token punctuation\">.</span>zero_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        l<span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        trainer<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    l <span class=\"token operator\">=</span> loss<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"epoch </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>epoch <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">, loss </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>l<span class=\"token punctuation\">:</span><span class=\"token format-spec\">f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><div class=\"links\"><div class=\"item\" title=\"Dive into Deep Learning\" style=\"--block-color:#e9546b;\"><a href=\"[https://d2l.ai/](https://d2l.ai/)\" class=\"image\" data-background-image=\"/assets/pexels-11.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://d2l.ai/](https://d2l.ai/)\" class=\"title\">d2l.ai：线性回归</a>\n          <p class=\"desc\">《动手学深度学习》线性回归与从零实现相关章节</p>\n          </div></div><div class=\"item\" title=\"PyTorch\" style=\"--block-color:#4e7cff;\"><a href=\"[https://pytorch.org/docs/stable/generated/torch.nn.Linear.html](https://pytorch.org/docs/stable/generated/torch.nn.Linear.html)\" class=\"image\" data-background-image=\"/assets/pexels-11.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://pytorch.org/docs/stable/generated/torch.nn.Linear.html](https://pytorch.org/docs/stable/generated/torch.nn.Linear.html)\" class=\"title\">PyTorch Linear 文档</a>\n          <p class=\"desc\">nn.Linear 的参数与用法说明</p>\n          </div></div></div></p>\n",
            "tags": [
                "人工智能",
                "深度学习",
                "深度学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/ai/deep-learning/pytorch01/",
            "url": "https://crpdim.github.io/ai/deep-learning/pytorch01/",
            "title": "PyTorch 求导",
            "date_published": "2023-06-12T16:00:00.000Z",
            "content_html": "<h1 id=\"pytorch-求导\"><a class=\"anchor\" href=\"#pytorch-求导\">#</a> PyTorch 求导</h1>\n<details class=\"info\"><summary>阅读提示</summary><div>\n<p>本文聚焦 PyTorch 的自动微分（Autograd）机制与常见用法：标量反向传播、梯度累计与清零，以及非标量输出如何通过  <code>sum()</code> （或传入  <code>gradient</code>  参数）来完成反传。</p>\n</div></details>\n<blockquote>\n<p>导数的计算几乎是所有深度学习优化算法的关键步骤。在深度学习中，通常会选择模型参数可微的损失函数：也就是对每个参数增加或减少一个无穷小量时，可以知道损失会以多大的速度增加或减少。</p>\n</blockquote>\n<p>偏导：在深度学习中，函数通常依赖许多变量，因此需要将微分思想推广到多元函数上，即求某变量的偏导。<br />\n梯度：将多元函数的所有偏导数组合起来，可以得到该函数的梯度向量。</p>\n<h2 id=\"自动微分\"><a class=\"anchor\" href=\"#自动微分\">#</a> 自动微分</h2>\n<blockquote>\n<p>深度学习框架通过自动计算导数（自动微分）加快求导。</p>\n</blockquote>\n<h3 id=\"举个例子对函数-y-2xtx-关于列向量-x-求导\"><a class=\"anchor\" href=\"#举个例子对函数-y-2xtx-关于列向量-x-求导\">#</a> 举个例子：对函数 y = 2xᵀx 关于列向量 x 求导</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>x <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># x = tensor([0., 1., 2., 3.])</span></pre></td></tr></table></figure><p>这里创建变量 x 并赋初值。要计算函数 y 关于 x 的梯度，需要一块区域存放梯度；这样就不需要对每个参数求导时重复分配内存。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>x<span class=\"token punctuation\">.</span>requires_grad_<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 等价于 x = torch.arange (4.0, requires_grad=True)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># y 关于 x 的梯度会存放在 x.grad 中</span></pre></td></tr></table></figure><p>计算函数 y：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>y <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> torch<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># y = 2 *（x 的内积）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># y = tensor(28., grad_fn=&lt;MulBackward0>)</span></pre></td></tr></table></figure><p>通过反向传播得到 y 关于变量 x 每个分量的梯度：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>y<span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 反向传播</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印 y 关于 x 每个分量的梯度</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># tensor([ 0.,  4.,  8., 12.])</span></pre></td></tr></table></figure><p>函数 y = 2xᵀx 关于 x 的梯度应为 4x，而 4 * x = tensor ([0.,  4.,  8., 12.])，因此梯度计算正确。</p>\n<p>默认情况下，PyTorch 会<strong>累计</strong>梯度，因此如果需要继续计算关于 x 的另一个函数，需先清空之前的梯度：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>x<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">.</span>zero_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 清空梯度</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 此时就可以计算其他函数关于 x 的梯度</span></pre></td></tr></table></figure><h3 id=\"对非标量变量的反向传播y-x-x\"><a class=\"anchor\" href=\"#对非标量变量的反向传播y-x-x\">#</a> 对非标量变量的反向传播：y = x * x</h3>\n<p>当 y 不是标量时，y 关于 x 的导数是一个矩阵。调用向量的反向传播时，我们常见目标并不是显式构造雅可比矩阵，而是得到 “各分量梯度的聚合结果”（例如对 batch 中每个样本损失求和后再反传）。</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>y <span class=\"token operator\">=</span> x <span class=\"token operator\">*</span> x  <span class=\"token comment\"># y 不是标量</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>y<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>grad<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># tensor([0., 2., 4., 6.])</span></pre></td></tr></table></figure><p><div class=\"links\"><div class=\"item\" title=\"PyTorch\" style=\"--block-color:#e9546b;\"><a href=\"[https://pytorch.org/docs/stable/autograd.html](https://pytorch.org/docs/stable/autograd.html)\" class=\"image\" data-background-image=\"/assets/pexels-11.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://pytorch.org/docs/stable/autograd.html](https://pytorch.org/docs/stable/autograd.html)\" class=\"title\">PyTorch Autograd 官方文档</a>\n          <p class=\"desc\">自动微分机制与 backward 用法说明</p>\n          </div></div><div class=\"item\" title=\"PyTorch\" style=\"--block-color:#4e7cff;\"><a href=\"[https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html](https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html)\" class=\"image\" data-background-image=\"/assets/pexels-11.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html](https://pytorch.org/tutorials/beginner/basics/autogradqs_tutorial.html)\" class=\"title\">PyTorch 张量与梯度教程</a>\n          <p class=\"desc\">入门教程：requires_grad、grad、反向传播</p>\n          </div></div></div></p>\n",
            "tags": [
                "人工智能",
                "深度学习",
                "深度学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/ai/deep-learning/tensorflow01/",
            "url": "https://crpdim.github.io/ai/deep-learning/tensorflow01/",
            "title": "TensorFlow",
            "date_published": "2023-05-29T16:00:00.000Z",
            "content_html": "<h1 id=\"tensorflow\"><a class=\"anchor\" href=\"#tensorflow\">#</a> TensorFlow</h1>\n<details class=\"info\"><summary>阅读提示</summary><div>\n<p>本文内容包含较多 TensorFlow 1.x 的概念与写法（Graph / Session）。TensorFlow 2.x 默认启用 Eager Execution，更推荐使用  <code>tf.function()</code>  来构建静态图； <code>tf.compat.v1.Session()</code>  虽仍可用，但一般不建议在新项目里继续依赖。</p>\n</div></details>\n<h2 id=\"tensorflow-介绍\"><a class=\"anchor\" href=\"#tensorflow-介绍\">#</a> TensorFlow 介绍</h2>\n<p><span class=\"rainbow\">TensorFlow</span> 是由 Google Brain 团队基于 Google 内部第一代深度学习系统 DistBelief 改进而来的通用计算框架。DistBelief 是 Google 于 2011 年开发的内部深度学习工具，并在公司内部取得了巨大成功。虽然 DistBelief 已被多个内部产品使用，但由于其过度依赖内部系统架构，难以对外开源，因此 Google Brain 对其进行改进，并在 2015 年正式发布基于 Apache 2.0 协议开源的 TensorFlow。相比 DistBelief，TensorFlow 的计算模型更通用、计算更快、支持平台更多、覆盖的深度学习算法更广，并且系统稳定性更高。</p>\n<h2 id=\"环境搭建\"><a class=\"anchor\" href=\"#环境搭建\">#</a> 环境搭建</h2>\n<p>TensorFlow 的构建与生态会涉及多个工具链（例如 Protocol Buffer、Bazel 等）。不过对大多数使用者来说，<strong>直接安装预编译版本</strong>是最省事的方式。</p>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<details><summary>默认默认 Conda 环境安装</summary><div>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>conda <span class=\"token function\">install</span> <span class=\"token parameter variable\">-c</span> anaconda tensorflow</pre></td></tr></table></figure></div></details>\n<details class=\"info\"><summary>Apple Silicon（M1/M2）安装说明</summary><div>\n<p>如果没有使用 conda 环境，按下面步骤一般也能安装成功；但如果你使用的是 Anaconda，建议换成 miniforge（避免踩 “Anaconda 对 Apple Silicon 支持不完整” 的坑）。</p>\n</div></details>\n<p><strong>M1 安装（示例流程）</strong></p>\n<ol>\n<li>\n<p>下载 tensorflow_macos（示例版本）</p>\n<ul>\n<li>访问： <code>https://github.com/apple/tensorflow_macos/releases</code></li>\n<li>选择： <code>tensorflow_macos-0.1alpha3.tar.gz</code></li>\n</ul>\n</li>\n<li>\n<p>下载 miniforge（arm64）</p>\n<ul>\n<li>访问： <code>https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-MacOSX-arm64.sh</code></li>\n</ul>\n</li>\n<li>\n<p>安装 miniforge（安装后重启终端）</p>\n</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/bin/bash ./Miniforge3-MacOSX-arm64.sh</pre></td></tr></table></figure><ol start=\"4\">\n<li>创建并激活虚拟环境</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>conda create <span class=\"token parameter variable\">-n</span> tensorflow_env <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3.8</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>conda activate tensorflow_env</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># conda deactivate 退出虚拟环境</span></pre></td></tr></table></figure><ol start=\"5\">\n<li>查看 Python 路径（确认当前环境）</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">which</span> python</pre></td></tr></table></figure><ol start=\"6\">\n<li>安装 tensorflow（示例：解压 + 依赖安装 + whl 安装）</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> tensorflow_macos-0.1alpha3.tar.gz <span class=\"token parameter variable\">-C</span> /Users/username/Local/Envs</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">libs</span><span class=\"token operator\">=</span><span class=\"token string\">\"/Users/username/Local/Envs/tensorflow_macos/arm64\"</span>   <span class=\"token comment\"># username 为当前用户目录名</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">env</span><span class=\"token operator\">=</span><span class=\"token string\">\"/Users/username/miniforge3/envs/tensorflow_env\"</span>       <span class=\"token comment\"># username 为当前用户目录名</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> pip wheel setuptools cached-property six</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> <span class=\"token parameter variable\">-t</span> <span class=\"token string\">\"<span class=\"token variable\">$env</span>/lib/python3.8/site-packages/\"</span> --no-dependencies <span class=\"token parameter variable\">--force</span> <span class=\"token string\">\"<span class=\"token variable\">$libs</span>/grpcio-1.33.2-cp38-cp38-macosx_11_0_arm64.whl\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> <span class=\"token parameter variable\">-t</span> <span class=\"token string\">\"<span class=\"token variable\">$env</span>/lib/python3.8/site-packages/\"</span> --no-dependencies <span class=\"token parameter variable\">--force</span> <span class=\"token string\">\"<span class=\"token variable\">$libs</span>/h5py-2.10.0-cp38-cp38-macosx_11_0_arm64.whl\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> <span class=\"token parameter variable\">-t</span> <span class=\"token string\">\"<span class=\"token variable\">$env</span>/lib/python3.8/site-packages/\"</span> --no-dependencies <span class=\"token parameter variable\">--force</span> <span class=\"token string\">\"<span class=\"token variable\">$libs</span>/numpy-1.18.5-cp38-cp38-macosx_11_0_arm64.whl\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> <span class=\"token parameter variable\">-t</span> <span class=\"token string\">\"<span class=\"token variable\">$env</span>/lib/python3.8/site-packages/\"</span> --no-dependencies <span class=\"token parameter variable\">--force</span> <span class=\"token string\">\"<span class=\"token variable\">$libs</span>/tensorflow_addons_macos-0.1a3-cp38-cp38-macosx_11_0_arm64.whl\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>pip <span class=\"token function\">install</span> absl-py astunparse flatbuffers gast google_pasta keras_preprocessing opt_einsum protobuf tensorflow_estimator termcolor typing_extensions wrapt wheel tensorboard typeguard</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>pip <span class=\"token function\">install</span> <span class=\"token parameter variable\">--upgrade</span> <span class=\"token parameter variable\">-t</span> <span class=\"token string\">\"<span class=\"token variable\">$env</span>/lib/python3.8/site-packages/\"</span> --no-dependencies <span class=\"token parameter variable\">--force</span> <span class=\"token string\">\"<span class=\"token variable\">$libs</span>/tensorflow_macos-0.1a3-cp38-cp38-macosx_11_0_arm64.whl\"</span></pre></td></tr></table></figure><p>安装完成后，进入对应环境测试：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> tensorflow</pre></td></tr></table></figure><h2 id=\"入门\"><a class=\"anchor\" href=\"#入门\">#</a> 入门</h2>\n<h3 id=\"计算图graph\"><a class=\"anchor\" href=\"#计算图graph\">#</a> 计算图（Graph）</h3>\n<blockquote>\n<p>计算图是 TensorFlow 最基本的概念之一：它<strong>定义计算</strong>，但<strong>不直接计算</strong>任何东西，也<strong>不包含实际数值</strong>。TensorFlow 中的计算会被转化为图上的节点（算子）以及边（张量流动）。</p>\n</blockquote>\n<p>TensorFlow 中，Tensor 是张量，Flow 是流：张量可以理解为多维数组，流表达了张量之间通过计算相互转化的过程。</p>\n<details class=\"info\"><summary>直观理解</summary><div>\n<p>“图” 描述的是：<strong>我要怎么计算</strong>；而真正 “跑起来拿到数值”，需要执行机制（TF1.x 的 Session，TF2.x 的 eager /tf.function）。</p>\n</div></details>\n<h3 id=\"张量tensor\"><a class=\"anchor\" href=\"#张量tensor\">#</a> 张量（Tensor）</h3>\n<blockquote>\n<p>张量是 TensorFlow 管理数据的形式。</p>\n</blockquote>\n<p>在 TensorFlow 中，数据以张量形式表示：零阶张量表示标量（scalar），一阶张量为向量（vector），n 阶张量可以理解为 n 维数组。需要注意的是：<strong>张量在 TensorFlow 中更像 “计算结果的引用”</strong>，它并不一定直接保存具体数值，而是保存 “如何得到这些数值” 的计算关系（尤其在静态图时代更明显）。</p>\n<h3 id=\"会话session\"><a class=\"anchor\" href=\"#会话session\">#</a> 会话（Session）</h3>\n<blockquote>\n<p>会话（Session）拥有并管理 TensorFlow 程序运行时的资源，它允许执行计算图（或其中一部分）。会话会分配资源（可能在一台或多台机器上）并维护中间结果与变量的实际值。</p>\n</blockquote>\n<p>TensorFlow 1.x 中常见的会话模式有两种：显式创建 / 关闭会话，或使用上下文管理器（这里给出显式方式）：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 创建一个会话</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 执行计算图中的某个张量 / 算子</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 关闭会话，释放资源</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>sess<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>下面对比 TF1.x 与 TF2.x 的 Hello World：</p>\n<p><strong>TF1.x：</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>msg <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">(</span><span class=\"token string\">'Hello, TensorFlow!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><strong>TF2.x：</strong></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>msg <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">(</span><span class=\"token string\">'Hello, TensorFlow!'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>tf<span class=\"token punctuation\">.</span><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><div class=\"links\"><div class=\"item\" title=\"TensorFlow\" style=\"--block-color:#e9546b;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly93d3cudGVuc29yZmxvdy5vcmcv\" data-background-image=\"//Fly1.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly93d3cudGVuc29yZmxvdy5vcmcv\">TensorFlow 官方文档</span>\n          <p class=\"desc\">安装、教程与 API 文档</p>\n          </div></div><div class=\"item\" title=\"Apple\" style=\"--block-color:#4e7cff;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FwcGxlL3RlbnNvcmZsb3dfbWFjb3MvcmVsZWFzZXM=\" data-background-image=\"//Fly1.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2FwcGxlL3RlbnNvcmZsb3dfbWFjb3MvcmVsZWFzZXM=\">Apple tensorflow_macos（历史方案）</span>\n          <p class=\"desc\">早期 Apple Silicon 上的 TF 发行包（示例流程用到）</p>\n          </div></div><div class=\"item\" title=\"conda-forge\" style=\"--block-color:#2bb673;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NvbmRhLWZvcmdlL21pbmlmb3JnZQ==\" data-background-image=\"//Fly1.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2NvbmRhLWZvcmdlL21pbmlmb3JnZQ==\">Miniforge（conda-forge）</span>\n          <p class=\"desc\">更适合 Apple Silicon 的 conda 发行版</p>\n          </div></div></div></p>\n",
            "tags": [
                "人工智能",
                "深度学习",
                "深度学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/ai/deep-learning/pytorch03/",
            "url": "https://crpdim.github.io/ai/deep-learning/pytorch03/",
            "title": "Softmax",
            "date_published": "2023-05-29T16:00:00.000Z",
            "content_html": "<h1 id=\"softmax-回归\"><a class=\"anchor\" href=\"#softmax-回归\">#</a> Softmax 回归</h1>\n<details class=\"info\"><summary>阅读提示</summary><div>\n<p>Softmax 回归常用于<strong>多类分类</strong>：用 n 个输出表示 n 个类别，再通过 softmax 把 “未归一化分数”（logits）变成<strong>非负且和为 1</strong> 的概率分布。本文包含 “从零实现” 和 “PyTorch 简洁实现” 两部分代码。</p>\n</div></details>\n<blockquote>\n<p>多类分类问题：n 个类别使用 n 个输出，通过 softmax 操作，使每个类的置信度成为概率（非负、和为 1）。</p>\n</blockquote>\n<h2 id=\"原理\"><a class=\"anchor\" href=\"#原理\">#</a> 原理</h2>\n<p>softmax 函数将未规范化的预测（logits）变换为非负并且总和为 1，同时要求模型保持可导。常见实现思路是：先对每个未规范化预测求幂以保证非负，再除以所有类别求幂后的总和以保证归一化（和为 1）。</p>\n<h2 id=\"从零开始实现\"><a class=\"anchor\" href=\"#从零开始实现\">#</a> 从零开始实现</h2>\n<h3 id=\"分类数据集fashion-mnist-数据集\"><a class=\"anchor\" href=\"#分类数据集fashion-mnist-数据集\">#</a> 分类数据集：Fashion-MNIST 数据集</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> torchvision</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> torch<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> data</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> torchvision <span class=\"token keyword\">import</span> transforms</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 通过框架中的内置函数将 Fashion-MNIST 数据集下载并读取到内存中</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>trans <span class=\"token operator\">=</span> transforms<span class=\"token punctuation\">.</span>ToTensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 下载训练数据集</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>mnist_train <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>FashionMNIST<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    root<span class=\"token operator\">=</span><span class=\"token string\">\"/data\"</span><span class=\"token punctuation\">,</span> train<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> transform<span class=\"token operator\">=</span>trans<span class=\"token punctuation\">,</span> download<span class=\"token operator\">=</span><span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 下载测试数据集，用来验证模型好坏</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>mnist_test <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>FashionMNIST<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    root<span class=\"token operator\">=</span><span class=\"token string\">\"/data\"</span><span class=\"token punctuation\">,</span> train<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> transform<span class=\"token operator\">=</span>trans<span class=\"token punctuation\">,</span> download<span class=\"token operator\">=</span><span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># 返回 Fashion-MNIST 数据集的文本标签</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_fashion_mnist_labels</span><span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    text_labels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token string\">'t-shirt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'trouser'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pullover'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dress'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coat'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token string\">'sandal'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'shirt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sneaker'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bag'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ankle boot'</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>text_labels<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> labels<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># 绘制图像列表函数</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">show_images</span><span class=\"token punctuation\">(</span>imgs<span class=\"token punctuation\">,</span> num_rows<span class=\"token punctuation\">,</span> num_cols<span class=\"token punctuation\">,</span> titles<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> scale<span class=\"token operator\">=</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    figsize <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>num_cols <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">,</span> num_rows <span class=\"token operator\">*</span> scale<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    _<span class=\"token punctuation\">,</span> axes <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span>num_rows<span class=\"token punctuation\">,</span> num_cols<span class=\"token punctuation\">,</span> figsize<span class=\"token operator\">=</span>figsize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    axes <span class=\"token operator\">=</span> axes<span class=\"token punctuation\">.</span>flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>ax<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>axes<span class=\"token punctuation\">,</span> imgs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token keyword\">if</span> torch<span class=\"token punctuation\">.</span>is_tensor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            ax<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>numpy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            ax<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        ax<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>get_xaxis<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_visible<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        ax<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">.</span>get_yaxis<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_visible<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token keyword\">if</span> titles<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            ax<span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span>titles<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">return</span> axes</pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>X<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">iter</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span>mnist_train<span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>show_images<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> titles<span class=\"token operator\">=</span>get_fashion_mnist_labels<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>batch_size <span class=\"token operator\">=</span> <span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">get_dataloader_workers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token comment\"># 使用四个进程读取数据，加快读取速度</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>train_iter <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    mnist_train<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> num_workers<span class=\"token operator\">=</span>get_dataloader_workers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>timer <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> train_iter<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">continue</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>timer<span class=\"token punctuation\">.</span>stop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token format-spec\">.2f</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> sec'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">load_data_fashion_mnist</span><span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">,</span> resize<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"下载 Fashion-MNIST 数据集，然后将其加载到内存中\"\"\"</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    trans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>transforms<span class=\"token punctuation\">.</span>ToTensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">if</span> resize<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        trans<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> transforms<span class=\"token punctuation\">.</span>Resize<span class=\"token punctuation\">(</span>resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    trans <span class=\"token operator\">=</span> transforms<span class=\"token punctuation\">.</span>Compose<span class=\"token punctuation\">(</span>trans<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    mnist_train <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>FashionMNIST<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        root<span class=\"token operator\">=</span><span class=\"token string\">\"/data\"</span><span class=\"token punctuation\">,</span> train<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> transform<span class=\"token operator\">=</span>trans<span class=\"token punctuation\">,</span> download<span class=\"token operator\">=</span><span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    mnist_test <span class=\"token operator\">=</span> torchvision<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>FashionMNIST<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        root<span class=\"token operator\">=</span><span class=\"token string\">\"/data\"</span><span class=\"token punctuation\">,</span> train<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> transform<span class=\"token operator\">=</span>trans<span class=\"token punctuation\">,</span> download<span class=\"token operator\">=</span><span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>        data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span>mnist_train<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                        num_workers<span class=\"token operator\">=</span>get_dataloader_workers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        data<span class=\"token punctuation\">.</span>DataLoader<span class=\"token punctuation\">(</span>mnist_test<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">,</span> shuffle<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                        num_workers<span class=\"token operator\">=</span>get_dataloader_workers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"实现-softmax-回归\"><a class=\"anchor\" href=\"#实现-softmax-回归\">#</a> 实现 softmax 回归</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> IPython <span class=\"token keyword\">import</span> display</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>batch_size <span class=\"token operator\">=</span> <span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>train_iter<span class=\"token punctuation\">,</span> test_iter <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>load_data_fashion_mnist<span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>num_inputs <span class=\"token operator\">=</span> <span class=\"token number\">784</span>     <span class=\"token comment\"># 28×28 展平为 784</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>num_outputs <span class=\"token operator\">=</span> <span class=\"token number\">10</span>     <span class=\"token comment\"># 10 类</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>W <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>num_inputs<span class=\"token punctuation\">,</span> num_outputs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> requires_grad<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>b <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>num_outputs<span class=\"token punctuation\">,</span> requires_grad<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\"># 定义 softmax：exp -> 行求和 -> 归一化</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">softmax</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    X_exp <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    partition <span class=\"token operator\">=</span> X_exp<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> keepdim<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">return</span> X_exp <span class=\"token operator\">/</span> partition</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\"># 定义模型：Flatten + Linear + Softmax</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">net</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> softmax<span class=\"token punctuation\">(</span>torch<span class=\"token punctuation\">.</span>matmul<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>y <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>tensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>y_hat <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>tensor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># 定义交叉熵损失函数</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">cross_entropy</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span>torch<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">[</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\"># 计算预测正确数量</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">accuracy</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span> <span class=\"token keyword\">and</span> y_hat<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        y_hat <span class=\"token operator\">=</span> y_hat<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token builtin\">cmp</span> <span class=\"token operator\">=</span> y_hat<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> y</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">cmp</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">.</span>dtype<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\"># 累加器：用于累加多个统计量</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Accumulator</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        self<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> n</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        self<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>a <span class=\"token operator\">+</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> a<span class=\"token punctuation\">,</span> b <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">reset</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>        self<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__getitem__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># 在指定数据集上评估精度</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">evaluate_accuracy</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> data_iter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>Module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        net<span class=\"token punctuation\">.</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    metric <span class=\"token operator\">=</span> Accumulator<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 正确数、总数</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> data_iter<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        metric<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>accuracy<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>numel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">return</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\"># 训练一个 epoch</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">train_epoch_ch3</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> train_iter<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> updater<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>nn<span class=\"token punctuation\">.</span>Module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        net<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    metric <span class=\"token operator\">=</span> Accumulator<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 损失和、正确和、样本数</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> train_iter<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        y_hat <span class=\"token operator\">=</span> net<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        l <span class=\"token operator\">=</span> loss<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>updater<span class=\"token punctuation\">,</span> torch<span class=\"token punctuation\">.</span>optim<span class=\"token punctuation\">.</span>Optimizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            updater<span class=\"token punctuation\">.</span>zero_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            l<span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            updater<span class=\"token punctuation\">.</span>step<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            metric<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> accuracy<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>numel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            l<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>backward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            updater<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            metric<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> accuracy<span class=\"token punctuation\">(</span>y_hat<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">.</span>numel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token keyword\">return</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> metric<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token comment\"># 动画器：展示训练过程</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Animator</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> xlabel<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> ylabel<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> legend<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> xlim<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>                 ylim<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> xscale<span class=\"token operator\">=</span><span class=\"token string\">'linear'</span><span class=\"token punctuation\">,</span> yscale<span class=\"token operator\">=</span><span class=\"token string\">'linear'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                 fmts<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'m--'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'g-.'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nrows<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ncols<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                 figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token keyword\">if</span> legend <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>            legend <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        d2l<span class=\"token punctuation\">.</span>use_svg_display<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        self<span class=\"token punctuation\">.</span>fig<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>axes <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">.</span>subplots<span class=\"token punctuation\">(</span>nrows<span class=\"token punctuation\">,</span> ncols<span class=\"token punctuation\">,</span> figsize<span class=\"token operator\">=</span>figsize<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">if</span> nrows <span class=\"token operator\">*</span> ncols <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>            self<span class=\"token punctuation\">.</span>axes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        self<span class=\"token punctuation\">.</span>config_axes <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span><span class=\"token punctuation\">:</span> d2l<span class=\"token punctuation\">.</span>set_axes<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>            self<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> xlabel<span class=\"token punctuation\">,</span> ylabel<span class=\"token punctuation\">,</span> xlim<span class=\"token punctuation\">,</span> ylim<span class=\"token punctuation\">,</span> xscale<span class=\"token punctuation\">,</span> yscale<span class=\"token punctuation\">,</span> legend</pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>        self<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>fmts <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> fmts</pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> <span class=\"token string\">\"__len__\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>            y <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>y<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token string\">\"__len__\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>            x <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> n</pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>            self<span class=\"token punctuation\">.</span>X <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>            self<span class=\"token punctuation\">.</span>Y <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>        <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>            <span class=\"token keyword\">if</span> a <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">and</span> b <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                self<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                self<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        self<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>cla<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token keyword\">for</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> fmt <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>fmts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            self<span class=\"token punctuation\">.</span>axes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        self<span class=\"token punctuation\">.</span>config_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>        display<span class=\"token punctuation\">.</span>display<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>fig<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        d2l<span class=\"token punctuation\">.</span>plt<span class=\"token punctuation\">.</span>draw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>        display<span class=\"token punctuation\">.</span>clear_output<span class=\"token punctuation\">(</span>wait<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre><span class=\"token comment\"># 训练函数</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">train_ch3</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> train_iter<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> num_epochs<span class=\"token punctuation\">,</span> updater<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>    animator <span class=\"token operator\">=</span> Animator<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        xlabel<span class=\"token operator\">=</span><span class=\"token string\">'epoch'</span><span class=\"token punctuation\">,</span> xlim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> num_epochs<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> ylim<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        legend<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'train loss'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'train acc'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'test acc'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>    <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>    <span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_epochs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>        train_metrics <span class=\"token operator\">=</span> train_epoch_ch3<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> train_iter<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> updater<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>        test_acc <span class=\"token operator\">=</span> evaluate_accuracy<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>        animator<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>epoch <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> train_metrics <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>test_acc<span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>    train_loss<span class=\"token punctuation\">,</span> train_acc <span class=\"token operator\">=</span> train_metrics</pre></td></tr><tr><td data-num=\"128\"></td><td><pre>    <span class=\"token keyword\">assert</span> train_loss <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> train_loss</pre></td></tr><tr><td data-num=\"129\"></td><td><pre>    <span class=\"token keyword\">assert</span> <span class=\"token number\">0.7</span> <span class=\"token operator\">&lt;</span> train_acc <span class=\"token operator\">&lt;=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> train_acc</pre></td></tr><tr><td data-num=\"130\"></td><td><pre>    <span class=\"token keyword\">assert</span> <span class=\"token number\">0.7</span> <span class=\"token operator\">&lt;</span> test_acc <span class=\"token operator\">&lt;=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> test_acc</pre></td></tr><tr><td data-num=\"131\"></td><td><pre></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>lr <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre></pre></td></tr><tr><td data-num=\"134\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">updater</span><span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token keyword\">return</span> d2l<span class=\"token punctuation\">.</span>sgd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>W<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> lr<span class=\"token punctuation\">,</span> batch_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>num_epochs <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>train_ch3<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> train_iter<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">,</span> cross_entropy<span class=\"token punctuation\">,</span> num_epochs<span class=\"token punctuation\">,</span> updater<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre></pre></td></tr><tr><td data-num=\"140\"></td><td><pre><span class=\"token comment\"># 预测函数</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">predict_ch3</span><span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">,</span> n<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>    <span class=\"token keyword\">for</span> X<span class=\"token punctuation\">,</span> y <span class=\"token keyword\">in</span> test_iter<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>        <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>    trues <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>get_fashion_mnist_labels<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    preds <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>get_fashion_mnist_labels<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    titles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>true <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span> <span class=\"token operator\">+</span> pred <span class=\"token keyword\">for</span> true<span class=\"token punctuation\">,</span> pred <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>trues<span class=\"token punctuation\">,</span> preds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>    d2l<span class=\"token punctuation\">.</span>show_images<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> titles<span class=\"token operator\">=</span>titles<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>predict_ch3<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"softmax-简洁实现\"><a class=\"anchor\" href=\"#softmax-简洁实现\">#</a> softmax 简洁实现</h2>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> torch</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> torch <span class=\"token keyword\">import</span> nn</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> d2l <span class=\"token keyword\">import</span> torch <span class=\"token keyword\">as</span> d2l</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>batch_size <span class=\"token operator\">=</span> <span class=\"token number\">256</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>train_iter<span class=\"token punctuation\">,</span> test_iter <span class=\"token operator\">=</span> d2l<span class=\"token punctuation\">.</span>load_data_fashion_mnist<span class=\"token punctuation\">(</span>batch_size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\"># 定义展平层 + 线性层：输入 784，输出 10</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>net <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span>nn<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">(</span><span class=\"token number\">784</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">init_weights</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> nn<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        nn<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">.</span>normal_<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span>weight<span class=\"token punctuation\">,</span> std<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>net<span class=\"token punctuation\">.</span><span class=\"token builtin\">apply</span><span class=\"token punctuation\">(</span>init_weights<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>loss <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>CrossEntropyLoss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>trainer <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>optim<span class=\"token punctuation\">.</span>SGD<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">.</span>parameters<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lr<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>num_epochs <span class=\"token operator\">=</span> <span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>d2l<span class=\"token punctuation\">.</span>train_ch3<span class=\"token punctuation\">(</span>net<span class=\"token punctuation\">,</span> train_iter<span class=\"token punctuation\">,</span> test_iter<span class=\"token punctuation\">,</span> loss<span class=\"token punctuation\">,</span> num_epochs<span class=\"token punctuation\">,</span> trainer<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><div class=\"links\"><div class=\"item\" title=\"Dive into Deep Learning\" style=\"--block-color:#e9546b;\"><a href=\"[https://d2l.ai/](https://d2l.ai/)\" class=\"image\" data-background-image=\"/assets/cuenca.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://d2l.ai/](https://d2l.ai/)\" class=\"title\">d2l.ai：Softmax 回归</a>\n          <p class=\"desc\">《动手学深度学习》Softmax 回归与交叉熵相关章节</p>\n          </div></div><div class=\"item\" title=\"PyTorch\" style=\"--block-color:#4e7cff;\"><a href=\"[https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html](https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html)\" class=\"image\" data-background-image=\"/assets/cuenca.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"[https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html](https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html)\" class=\"title\">PyTorch CrossEntropyLoss 文档</a>\n          <p class=\"desc\">交叉熵损失函数的定义与输入输出要求</p>\n          </div></div></div></p>\n",
            "tags": [
                "人工智能",
                "深度学习",
                "深度学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/english/Absolute-Construction/",
            "url": "https://crpdim.github.io/english/Absolute-Construction/",
            "title": "独立主格结构",
            "date_published": "2023-04-15T12:46:25.000Z",
            "content_html": "<h1 id=\"独立主格\"><a class=\"anchor\" href=\"#独立主格\">#</a> 独立主格</h1>\n<blockquote>\n<p>在非谓语动词中过去分词时提到过</p>\n</blockquote>\n",
            "tags": [
                "英语学习",
                "英语语法"
            ]
        },
        {
            "id": "https://crpdim.github.io/english/Non-Finite-Verbs-02/",
            "url": "https://crpdim.github.io/english/Non-Finite-Verbs-02/",
            "title": "非谓语动词02",
            "date_published": "2023-04-14T12:46:25.000Z",
            "content_html": "<h1 id=\"动名词\"><a class=\"anchor\" href=\"#动名词\">#</a> 动<mark>名词</mark></h1>\n<blockquote>\n<p>动名词相当于名词</p>\n</blockquote>\n<h2 id=\"动名词作主语\"><a class=\"anchor\" href=\"#动名词作主语\">#</a> 动名词作主语</h2>\n<p><mark>Eating carrots</mark> is healthy for the rabbit.</p>\n<p>在这句话中，eating carrot 是一个动名词短语，将动词 eat 转换成了名词的性质，表达吃胡萝卜这个行为。</p>\n<h2 id=\"动名词作主语补语表语\"><a class=\"anchor\" href=\"#动名词作主语补语表语\">#</a> 动名词作主语补语（表语）</h2>\n<p>The rabbit's hobby is <mark>growing carrots.</mark>  兔子的爱好是种胡萝卜。</p>\n<p>动名词短语 growing carrots 作句子的表语</p>\n<p><ins>Seeing</ins> is <mark>believing</mark>. 眼见为实</p>\n<p>这句谚语中动名词 seeing 作主语， 动名词 believing 作表语。</p>\n<h2 id=\"动名词作定语\"><a class=\"anchor\" href=\"#动名词作定语\">#</a> 动名词作定语</h2>\n<p>A <mark>sleeping</mark> pill。一片安眠药</p>\n<p>这里的 sleeping 作 pill 的定语，说明 pill 的用途（睡眠用的）</p>\n<p>所以 a <mark>sleeping</mark> pill = a pill for <mark>sleeping</mark>。</p>\n<div class=\"note danger\">\n<p><span class=\"label danger\">💔danger</span>  这里的 sleeping 都是当名词使用，并非在说 pill 在睡觉。</p>\n</div>\n<h2 id=\"动名词作宾语\"><a class=\"anchor\" href=\"#动名词作宾语\">#</a> 动名词作宾语</h2>\n<p>The rabbit likes <mark>eating</mark> carrots. 兔子喜欢吃胡萝卜。</p>\n<details class=\"info\"><summary>用不定式作宾语可以写成 The rabbit likes to eat carrots. 意思也是兔子喜欢吃胡萝卜，这两种形式有什么区别呢？</summary><div>\n<p>&quot;like to do vs like doing&quot; 这个我也没能理解，不同动词不定式与动名词区别不同，有的动词区别就很明显，如：</p>\n<ul>\n<li>The rabbit stopped to eat a carrot. 表示兔子停下（手里的活）去吃一个胡萝卜</li>\n<li>The rabbit stopped eating a carrot.  兔子停止吃一根胡萝卜</li>\n<li>forget doing sth. 忘记做过的事情</li>\n<li>forget to do sth. 忘记要做的事情</li>\n<li>remember doing sth. 想起做过的事情</li>\n<li>remember to do sth. 想起要做的事情</li>\n</ul>\n</div></details>\n<p>但是对于某些动词后，如 enjoy，就不能用不定式作宾语。</p>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" disabled=\"true\" /><label for=\"cbx_0\"> <s>The rabbit enjoys to eat carrots.</s></label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_1\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_1\"> 必须写成 The rabbit enjoys eating carrots.</label></li>\n</ul>\n<p>这样的动词还有 avoid, advise, consider, escape, mind, practice 等，动词词组有 insist on, give up, feel like, put off 等.</p>\n<p>有时介词后面也接宾语，此时要将动词变为非谓语动词，也要使用动名词形式</p>\n<p>有时还会遇到 to 作为介词的词组，注意不要将它看作不定式。如：</p>\n<p>The rabbit is looking forward to <mark>seeing</mark> the wolf. 兔子期待再次见到狼。</p>\n<p>在这一句中，look forward to 是一个动词短语，to 是个介词</p>\n<h1 id=\"现在分词\"><a class=\"anchor\" href=\"#现在分词\">#</a> 现在分词</h1>\n<blockquote>\n<p>现在分词并不表示现在时间</p>\n</blockquote>\n<p>A <mark>talking</mark> rabbit  一只会说话的兔子</p>\n<p>这里 talking 是现在分词作定语</p>\n<details class=\"info\"><summary>但是之前有说过动名词也可以作定语，如a sleeping pill，怎么判断是动名词还是现在分词呢</summary><div>\n<p>a <ins>sleeping</ins> pill 这里 sleeping 是动名词，用来说明 pill 的性质、功能和用途，相当于 a pill for sleeping</p>\n<p>a <mark>sleeping</mark> rabbit 这里的 sleeping 表示这是只在睡觉的兔子，不是名词而是充当形容词，表示兔子的状态</p>\n</div></details>\n<h2 id=\"现在分词作表语\"><a class=\"anchor\" href=\"#现在分词作表语\">#</a> 现在分词作表语</h2>\n<p>The rabbit is <mark>charming</mark>.</p>\n<p>The game is <mark>exciting</mark>.</p>\n<h2 id=\"现在分词作宾语补足语\"><a class=\"anchor\" href=\"#现在分词作宾语补足语\">#</a> 现在分词作宾语补足语</h2>\n<p>The wolf saw the rabbit <mark>eating</mark> a carrot. 狼之前看到兔子正在吃胡萝卜。</p>\n<details class=\"info\"><summary>不定式作宾语补语的用法</summary><div>\n<p>The wolf saw the rabbit <ins>eat</ins> a carrot. 狼之前看到兔子吃了根胡萝卜。</p>\n<p>不定式与现在分词作宾语的区别：</p>\n<ul>\n<li>不定式作宾语，表示动作自始至终的过程，强调动作已经发生了。</li>\n<li>现在分词作宾语，表示动作正在进行中，强调进行的状态。</li>\n</ul>\n</div></details>\n<h2 id=\"现在分词作状语\"><a class=\"anchor\" href=\"#现在分词作状语\">#</a> 现在分词作状语</h2>\n<blockquote>\n<p>表示时间、原因、条件、结果、让步、目的、方式和伴随情况等</p>\n</blockquote>\n<ul>\n<li>表时间： Hearing the news, the rabbit became excited. 听到这个消息，兔子变得很激动</li>\n<li>表原因：Not knowing what to eat, the rabbit skipped lunch. 不知道吃什么，兔子没吃中饭。</li>\n</ul>\n<h1 id=\"过去分词\"><a class=\"anchor\" href=\"#过去分词\">#</a> 过去分词</h1>\n<blockquote>\n<p>过去分词并不表示过去的时间。</p>\n</blockquote>\n<p>The rabbit will eat <mark>minced</mark> carrot next week. 兔子下周会吃被搅碎的胡萝卜</p>\n<p>之句话中，minced 不带时间概念，只是指被搅碎这个状态</p>\n<p>常见过去分词为动词 + ed，也有很多不常见的需要积累</p>\n<table>\n<thead>\n<tr>\n<th>动词原形</th>\n<th>过去分词形式</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>eat</td>\n<td>eaten</td>\n</tr>\n<tr>\n<td>see</td>\n<td>seen</td>\n</tr>\n<tr>\n<td>cut</td>\n<td>cut</td>\n</tr>\n<tr>\n<td>grow</td>\n<td>grown</td>\n</tr>\n<tr>\n<td>tell</td>\n<td>told</td>\n</tr>\n</tbody>\n</table>\n<p>上述例句中 minced 为过去分词作定语，一般在修饰的名词前，但是过去分词短语作定语则需要放在被修饰的名词之后，作后置定语：</p>\n<p>The carrot cake <mark>eaten</mark> by the rabbit is delicious.</p>\n<h2 id=\"过去分词作主语补语\"><a class=\"anchor\" href=\"#过去分词作主语补语\">#</a> 过去分词作主语补语</h2>\n<p>The rabbit is <mark>interested</mark> in growing carrots. 兔子对种胡萝卜感兴趣。</p>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">&quot;sb. is interested in doing sth&quot; 就是过去分词”interested“作表语的主系表结构</span></p>\n<details class=\"info\"><summary>过去分词作表语vs现在分词作表语</summary><div>\n<ul>\n<li>The story is <mark>interesting</mark>. 故事很有趣（主动）</li>\n<li>The rabbit is <mark>interested</mark>. 兔子很有兴趣（被动）</li>\n</ul>\n<p>现在分词暗含主动关系，描述做出动作的人或物</p>\n<p>过去分词暗含被动关系，描述动作的接收者</p>\n<ol>\n<li class=\"quiz\">下列哪一个表示兔子害怕</li>\n</ol>\n<ul>\n<li>The rabbit was <mark>frightening</mark>. <span class=\"spoiler\" title=\"好奇心害死猫\">兔子令人感到害怕</span></li>\n<li>The rabbit was <mark>frightened</mark>.{.correct}{.options}  <span class=\"spoiler\" title=\"好奇心害死猫\">兔子感到害怕</span></li>\n</ul>\n<p>I am interesting and interested. <span class=\"spoiler\" title=\"好奇心害死猫\">我既有趣又有兴趣</span></p>\n</div></details>\n<h2 id=\"过去分词作宾语补语\"><a class=\"anchor\" href=\"#过去分词作宾语补语\">#</a> 过去分词作宾语补语</h2>\n<p>The rabbit found his carrot <mark>stolen</mark>. 兔子发现他的胡萝卜被偷了</p>\n<h2 id=\"过去分词作状语\"><a class=\"anchor\" href=\"#过去分词作状语\">#</a> 过去分词作状语</h2>\n<p><mark>Seen</mark> from the hill, the carrot field looks beautiful. 从山上看，胡萝卜田看上去很美</p>\n<p><mark>Born</mark> in a rabbit family, the rabbit has been growing carrots all his life. 由于出生在一个兔子家庭中，兔子种了一辈子的胡萝卜</p>\n<p><mark>Given</mark> another chance, the rabbit would go to the wolf's party. 如果再给兔子一次机会，它会参加狼的聚会。</p>\n<p>如何确定是现在分词还是过去分词呢？为什么第一句不能写成 <s><mark>Seeing</mark> from the hill, the carrot field looks beautiful</s>？</p>\n<ul>\n<li>主动和被动主要看非谓语动词与主语的关系，这句话中动作 see 与主语 carrot field 是<ins>被动</ins>关系，萝卜田是被看到</li>\n<li><mark>Seeing</mark> the carrot field, the rabbit ran towards it. 这里主语是 rabbit，动作 see 是<ins>主动</ins>去看</li>\n</ul>\n<details class=\"info\"><summary>一个高级用法</summary><div>\n<p>The work <mark>finished</mark>, the rabbit went home. 工作完成后，兔子回家了。</p>\n<p>为什么不是兔子主动做工作？</p>\n<ul>\n<li>因为 finished 不是说兔子，而是说 work</li>\n<li>这句话相当于一个并列句：The work was finished, so the rabbit went home.</li>\n</ul>\n<p>The weather <mark>permitting</mark>, the rabbit will go out. 天气允许的话，兔子就出门了。</p>\n<p>相当于 If the weather permits, the rabbit will go out. weather 为现在分词形式，修饰 weather。</p>\n<p>这种结构（一个简单句，除去谓语动词外，其他的动词转化为对应的现在 / 过去分词形式）语法上称之为<ins>独立主格</ins>。</p>\n<p>因为现在 / 过去分词在句子中的状语里（并非主语），在状语本身中，分词修饰的对象（例句中的 work、weather）隐含了一层主语的意味（只有意味，相当于状语从句中的主语，并非整句的主语）</p>\n</div></details>\n",
            "tags": [
                "英语学习",
                "英语语法"
            ]
        },
        {
            "id": "https://crpdim.github.io/english/Non-Finite-Verbs/",
            "url": "https://crpdim.github.io/english/Non-Finite-Verbs/",
            "title": "非谓语动词(The Non-Finite Verbs)",
            "date_published": "2023-04-12T12:46:25.000Z",
            "content_html": "<h1 id=\"非谓语动词01\"><a class=\"anchor\" href=\"#非谓语动词01\">#</a> 非谓语动词 01</h1>\n<h2 id=\"谓语动词vs非谓语动词\"><a class=\"anchor\" href=\"#谓语动词vs非谓语动词\">#</a> 谓语动词 vs 非谓语动词</h2>\n<h3 id=\"谓语动词的三大本领\"><a class=\"anchor\" href=\"#谓语动词的三大本领\">#</a> 谓语动词的 “三大本领”</h3>\n<ol>\n<li>表示动作的时间</li>\n<li>表示动作的状态</li>\n<li>表示动作的假设、情感（语气）</li>\n</ol>\n<p>谓语动词可以受到主语限制，出现了时间、状态、语气的变化，实际上是一种被限定的动词。所以又称为限定性动词（Finite Verbs）</p>\n<p>如句子： The rabbit eats a carrot. 如果将主语 The rabbit 换成 I ，则 eats 需变为 eat</p>\n<h3 id=\"不受限定的动词非谓语动词the-non-finite-verbs\"><a class=\"anchor\" href=\"#不受限定的动词非谓语动词the-non-finite-verbs\">#</a> 不受限定的动词 —— 非谓语动词（The Non-Finite Verbs）</h3>\n<blockquote>\n<p>不受主语限制、不受限定的词，因此非谓语动词无法表达时间和人称</p>\n</blockquote>\n<p>例句：（<mark>荧光绿</mark>为谓语动词， <ins>下划线</ins>为非谓语动词）</p>\n<ul>\n<li>I <mark>like</mark> <ins>to eat</ins> carrots.</li>\n<li>I <mark>liked</mark> <ins>eating</ins> carrots</li>\n<li>I <mark>am</mark> a <ins>talking</ins> rabbit.</li>\n<li>The rabbit <mark>likes</mark> <ins>minced</ins> carrots.</li>\n</ul>\n<p>可见，谓语动词受主语限制，展现出时间、状态和语气的本领；非谓语动词不受主语限制，不具备表达时间和状态的能力</p>\n<h3 id=\"谓语动词与非谓语动词区别\"><a class=\"anchor\" href=\"#谓语动词与非谓语动词区别\">#</a> 谓语动词与非谓语动词区别</h3>\n<blockquote>\n<p>一个简单句的句子成分：什么（主语）怎么样（谓语），一个简单句中只能有一个体现怎么样的谓语动词；剩下的 &quot;像动词&quot; 的动词为非谓语。</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>谓语动词</th>\n<th>非谓语动词</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>句子的核心</td>\n<td>句子中非核心部分</td>\n</tr>\n</tbody>\n</table>\n<p>注意：两个简单句不能用 “，” 连接。</p>\n<p>如句子<s class=\"danger\"> I am a rabbit, I eat carrots.</s></p>\n<p>要么写成：I am a rabbit, so I eat carrots. (改成并列句，用连词连接)</p>\n<p>要么把它变为一个从句一个主句：Because I am a rabbit, I eat carrots.</p>\n<h2 id=\"非谓语动词-不定式\"><a class=\"anchor\" href=\"#非谓语动词-不定式\">#</a> 非谓语动词 - 不定式</h2>\n<blockquote>\n<p>不定式 (Infinitive) 是无限的意思，即不受限制</p>\n</blockquote>\n<p>通常不定式的结构为：to + 动词原形</p>\n<p>如： To be or not to be, that is the question. 生存还是毁灭，这是一个问题。</p>\n<p>to 有时可以省略，如 You helped me cook the carrot. 你帮我烧了胡萝卜。<span class=\"spoiler\" title=\"好奇心害死猫\">这句话中 helped 是谓语动词，cook 是不定式，只不过省略了 to.</span></p>\n<blockquote>\n<p>一个动词作为谓语动词，只能在句子中充当核心的谓语动词，而不能充当其他成分。如果想充当其他成分，只能将其转化为非谓语动词（不定式、过去分词、现在分词、动名词之一）</p>\n</blockquote>\n<h3 id=\"不定式作主语\"><a class=\"anchor\" href=\"#不定式作主语\">#</a> 不定式作主语</h3>\n<p><ins>To eat</ins> a carrot every day <mark>is</mark> good for the rabbit.</p>\n<p>在这个句子中，to eat 是动词不定式充当句子主语，表示一天吃一个胡萝卜这个行为，没有具体时间状态，所以是不定式。</p>\n<p>将 to eat a carrot every day 放到谓语动词之后，句子就变成了：</p>\n<p>It is good for the rabbit to eat a carrot every day.<span class=\"spoiler\" title=\"好奇心害死猫\">（句子形式为 It is + adj + for sb. + to do sth.）</span></p>\n<p>to eat 不定式为真正的主语，为避免头重脚轻，将 it 作形式主语放在句首。</p>\n<h3 id=\"不定式作宾语\"><a class=\"anchor\" href=\"#不定式作宾语\">#</a> 不定式作宾语</h3>\n<p>The rabbit <mark>likes</mark> <ins>to eat</ins> carrot.</p>\n<p>句子中 to eat 做了谓语动词 likes 的宾语</p>\n<p>注意：有些谓语动词不能接不定式作宾语</p>\n<p>可以用 “it” 作形式宾语吗？</p>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">可以： 如 I consider it important to eat a carrot every day. (我认为每天吃一个胡萝卜很重要)</span></p>\n<h3 id=\"不定式作宾语补语\"><a class=\"anchor\" href=\"#不定式作宾语补语\">#</a> 不定式作宾语补语</h3>\n<ol>\n<li>不定式可以与复杂及物动词一起使用</li>\n</ol>\n<p>The rabbit <mark>expected</mark> the wolf <ins>to eat</ins> a carrot. 兔子希望狼能吃根胡萝卜</p>\n<p>注意：像 see、find、watch、have、make、let 这类” 使役 “动词用不定式作宾补要省略 to，如：Carrots make the rabbit feel happy.</p>\n<h3 id=\"不定式作主语补语表语\"><a class=\"anchor\" href=\"#不定式作主语补语表语\">#</a> 不定式作主语补语（表语）</h3>\n<p>The rabbit's dream <mark>is</mark> <ins>to eat</ins> every kind of carrot in the world. (主系表结构)</p>\n<h3 id=\"不定式作定语\"><a class=\"anchor\" href=\"#不定式作定语\">#</a> 不定式作定语</h3>\n<p>The rabbit has a lot of carrots to eat. 兔子有很多胡萝卜要吃</p>\n<h3 id=\"不定式作状语表达原因-目的-结果\"><a class=\"anchor\" href=\"#不定式作状语表达原因-目的-结果\">#</a> 不定式作状语表达原因、目的、结果</h3>\n<h4 id=\"表原因\"><a class=\"anchor\" href=\"#表原因\">#</a> 表原因</h4>\n<p>I was surprised to get a thumbs-up. 我很吃惊因为得到了一个赞👍</p>\n<p>to get 不定式作原因状语</p>\n<p>相当于 I was surprised because I got a thumbs-up.</p>\n<h4 id=\"表目的\"><a class=\"anchor\" href=\"#表目的\">#</a> 表目的</h4>\n<p>I will do anything to get a thumbs-up. 为了得到一个赞，我愿意做任何事</p>\n<p>to get 不定式作目的状语</p>\n<p>相当于 I will do anything in order that I get a thumbs-up.</p>\n<h4 id=\"表结果\"><a class=\"anchor\" href=\"#表结果\">#</a> 表结果</h4>\n<p>I got enough thumbs-up to make another video. 我得到足够的赞去做另一个视频啦</p>\n<p>to make 不定式作结果状语</p>\n<p>相当于 I got enough thumbs-up, so that I made another video.</p>\n<h3 id=\"高级不定式\"><a class=\"anchor\" href=\"#高级不定式\">#</a> 高级不定式</h3>\n<blockquote>\n<p>to + 动词原形（添加状态）</p>\n</blockquote>\n<ul>\n<li>to be eating a carrot</li>\n<li>to have eaten a carrot</li>\n<li>to have been eating a carrot</li>\n</ul>\n<p>例句：</p>\n<p>The rabbit seemed to be eating a carrot.</p>\n<p>兔子之前似乎正在吃胡萝卜（的过程中）</p>\n<p>The rabbit will appear to have eaten a carrot.</p>\n<p>这兔子之后会看起来像是吃过一根胡萝卜</p>\n",
            "tags": [
                "英语学习",
                "英语语法"
            ]
        },
        {
            "id": "https://crpdim.github.io/english/Mood/",
            "url": "https://crpdim.github.io/english/Mood/",
            "title": "动词语气(Mood)",
            "date_published": "2023-04-11T12:46:25.000Z",
            "content_html": "<h1 id=\"语气\"><a class=\"anchor\" href=\"#语气\">#</a> 语气</h1>\n<p><div class=\"links\"><div class=\"item\" title=\"英语兔\" style=\"--block-color:#e9546b;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVhZNDExSjdhRw==\" data-background-image=\"https://media.yingyutu.com/huanying.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVhZNDExSjdhRw==\">英语兔</span>\n          <p class=\"desc\">笔记于英语兔语法学习专栏</p>\n          </div></div></div></p>\n<h1 id=\"动词语气mood\"><a class=\"anchor\" href=\"#动词语气mood\">#</a> 动词语气（Mood）</h1>\n<blockquote>\n<p>动词语气 <strong>≠</strong> 说话语气 <span class=\"spoiler\" title=\"好奇心害死猫\">温柔的、凶狠的……</span></p>\n<p>动词最主要的语气：陈述语气、祈使语气、虚拟语气）</p>\n</blockquote>\n<h2 id=\"谓语动词三大本领\"><a class=\"anchor\" href=\"#谓语动词三大本领\">#</a> 谓语动词三大本领</h2>\n<ul>\n<li>表示动作的时间（Tense）</li>\n<li>表示动作的状态（Aspect）</li>\n<li>表示动作的假设与情感（Mood）</li>\n</ul>\n<h2 id=\"陈述语气\"><a class=\"anchor\" href=\"#陈述语气\">#</a> 陈述语气</h2>\n<blockquote>\n<p>描述现实</p>\n</blockquote>\n<p>例如：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">The rabbit ate the carrot.</td>\n<td style=\"text-align:left\">这兔子吃了这胡萝卜。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Did the rabbit ate the carrot?</td>\n<td style=\"text-align:left\">兔子吃了这胡萝卜吗？</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"祈使语气\"><a class=\"anchor\" href=\"#祈使语气\">#</a> 祈使语气</h2>\n<blockquote>\n<p>表示命令请求</p>\n</blockquote>\n<h3 id=\"例如\"><a class=\"anchor\" href=\"#例如\">#</a> 例如：</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Rabbit, eat the carrot!</td>\n<td style=\"text-align:left\">兔子，吃了这胡萝卜！</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Please, give me an apple!</td>\n<td style=\"text-align:left\">求你了，给我个苹果！</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"语法构成\"><a class=\"anchor\" href=\"#语法构成\">#</a> 语法构成：</h3>\n<ol>\n<li>用第二人称 “<span class=\"spoiler\" title=\"好奇心害死猫\">你</span>”，并用一般现在时态表达</li>\n<li>去掉 “你”，并保证动词原形</li>\n<li>如： You eat the carrot! -&gt; Eat the carrot!</li>\n</ol>\n<h2 id=\"虚拟语气subjunctive-mood\"><a class=\"anchor\" href=\"#虚拟语气subjunctive-mood\">#</a> 虚拟语气（Subjunctive Mood）</h2>\n<blockquote>\n<p>描述脑中的想象（尤其是和现实想违背）或主观的意愿要用虚拟语气</p>\n</blockquote>\n<p>虚拟语气有两大用法：</p>\n<ol>\n<li>表示 “不可能” 假设，如要是我早上吃了鸡蛋，我一定能考好</li>\n<li>表达愿望、请求、建议、命令等。如：我希望我能考上北大</li>\n</ol>\n<h2 id=\"表不可能假设的虚拟语气用法\"><a class=\"anchor\" href=\"#表不可能假设的虚拟语气用法\">#</a> 表 “不可能” 假设的虚拟语气用法</h2>\n<h3 id=\"表示与现在事实相反\"><a class=\"anchor\" href=\"#表示与现在事实相反\">#</a> 表示与现在事实相反</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">If I saw the rabbit now, I would bite him.</td>\n<td style=\"text-align:left\">如果我现在看到这只兔子，我将会咬它</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">If I ware a rabbit， I would eat a carrot.<span class=\"spoiler\" title=\"好奇心害死猫\"> 虚拟语气若动词是 be，无论什么人称都用 were</span></td>\n<td style=\"text-align:left\">如果我是只兔子，我会吃掉胡萝卜</td>\n</tr>\n</tbody>\n</table>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">这里的过去式不是指过去，而是指现在没发生但希望发生的动作</span></p>\n<h4 id=\"结构\"><a class=\"anchor\" href=\"#结构\">#</a> 结构</h4>\n<ul>\n<li>条件句：过去式</li>\n<li>主句：would + 动词原形</li>\n</ul>\n<h3 id=\"表示在将来时间里可能性很小的动作\"><a class=\"anchor\" href=\"#表示在将来时间里可能性很小的动作\">#</a> 表示在将来时间里可能性很小的动作</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">If I should see the rabbit tomorrow, I would bite him.</td>\n<td style=\"text-align:left\">如果我明天看到这只兔子，我将会咬它</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">If I should meet thee after long years, how should I greet thee？</td>\n<td style=\"text-align:left\">万一我们将来重逢了，我又该如何面对呢？<span class=\"spoiler\" title=\"好奇心害死猫\">言下之意：我们相会遥遥无期</span></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"结构-2\"><a class=\"anchor\" href=\"#结构-2\">#</a> 结构</h4>\n<ul>\n<li>条件句：should + 动词原形</li>\n<li>主句：would + 动词原形</li>\n</ul>\n<h3 id=\"表示与过去的事实相反\"><a class=\"anchor\" href=\"#表示与过去的事实相反\">#</a> 表示与过去的事实相反</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">If I had seen the rabbit a few days age, I would have bitten him.</td>\n<td style=\"text-align:left\">如果前几天我看到那只兔子，我应该已经咬过它了<span class=\"spoiler\" title=\"好奇心害死猫\">言下之意：我并没有咬到那只兔子</span></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"结构-3\"><a class=\"anchor\" href=\"#结构-3\">#</a> 结构</h4>\n<ul>\n<li>条件句：had + 动词过去分词</li>\n<li>主句：would have + 动词过去分词</li>\n</ul>\n<h2 id=\"表愿望-请求-建议-命令的虚拟语气用法\"><a class=\"anchor\" href=\"#表愿望-请求-建议-命令的虚拟语气用法\">#</a> 表 “愿望、请求、建议、命令” 的虚拟语气用法</h2>\n<blockquote>\n<p>表达愿望不只有 wish，would rather 也可以。或者使用 demand、suggest、insist、order 等，注意后面的虚拟语气用 should + 动词原形，如 I suggest that you should eat a carrot.</p>\n</blockquote>\n<h3 id=\"表示对现在的愿望\"><a class=\"anchor\" href=\"#表示对现在的愿望\">#</a> 表示对现在的愿望</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">I wish that I were a rabbit.</td>\n<td style=\"text-align:left\">我希望我是一只兔子</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">I would rather that you didn't eat the carrot. <span class=\"spoiler\" title=\"好奇心害死猫\">表达愿望不只有 wish，would rather 也可以</span></td>\n<td style=\"text-align:left\">我宁愿你不吃那根胡萝卜</td>\n</tr>\n</tbody>\n</table>\n<p>注意： <span class=\"spoiler\" title=\"好奇心害死猫\">虚拟语气若动词是 be，无论什么人称都用 were</span></p>\n<ol>\n<li class=\"quiz\">I wish you were here！\n<ul class=\"options\">\n<li>我希望你曾来过这儿</li>\n<li class=\"correct\">我希望你现在就在这儿</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"结构-4\"><a class=\"anchor\" href=\"#结构-4\">#</a> 结构</h4>\n<ul>\n<li>wish + 动词过去式</li>\n</ul>\n<h3 id=\"表示对过去的愿望\"><a class=\"anchor\" href=\"#表示对过去的愿望\">#</a> 表示对过去的愿望</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">I wish I had eaten the carrot.</td>\n<td style=\"text-align:left\">我希望我吃了那根胡萝卜</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"结构-5\"><a class=\"anchor\" href=\"#结构-5\">#</a> 结构</h4>\n<ul>\n<li>wish+had/would have + 动词过去分词</li>\n</ul>\n<h3 id=\"表示对将来的愿望\"><a class=\"anchor\" href=\"#表示对将来的愿望\">#</a> 表示对将来的愿望</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">英</th>\n<th style=\"text-align:left\">汉</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">I wish I could eat the carrot.</td>\n<td style=\"text-align:left\">我希望我能吃那根胡萝卜。</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"结构-6\"><a class=\"anchor\" href=\"#结构-6\">#</a> 结构</h4>\n<ul>\n<li>wish+should/would/might/could + 动词原形</li>\n</ul>\n",
            "tags": [
                "英语学习",
                "英语语法"
            ]
        },
        {
            "id": "https://crpdim.github.io/ai/machine-learning/machine_course02/",
            "url": "https://crpdim.github.io/ai/machine-learning/machine_course02/",
            "title": "机器学习课程02-浅谈机器学习原理",
            "date_published": "2023-03-29T16:00:00.000Z",
            "content_html": "<h1 id=\"宝可梦与数码宝贝的分类器-浅谈机器学习原理\"><a class=\"anchor\" href=\"#宝可梦与数码宝贝的分类器-浅谈机器学习原理\">#</a> 宝可梦与数码宝贝的分类器 - 浅谈机器学习原理</h1>\n<blockquote>\n<p>目的：找到一个函数可以分辨宝可梦与数码宝贝</p>\n</blockquote>\n<h2 id=\"定一个含有未知数h的函数\"><a class=\"anchor\" href=\"#定一个含有未知数h的函数\">#</a> 定一个含有未知数 h 的函数</h2>\n<h3 id=\"根据画风差异分辨宝可梦与数码宝贝\"><a class=\"anchor\" href=\"#根据画风差异分辨宝可梦与数码宝贝\">#</a> 根据画风差异分辨宝可梦与数码宝贝</h3>\n<ol>\n<li>\n<p>分析线条的复杂程度（数码宝贝较复杂， 宝可梦较简单）</p>\n<ul>\n<li>提取图片中的边缘线</li>\n<li>得到边缘线像素点的数量</li>\n<li>边缘像素点的数量就代表边缘的复杂程度</li>\n</ul>\n</li>\n<li>\n<p>根据此生成一个函数，函数中有一未知参数 h。</p>\n<ul>\n<li>\n<p>输入精灵图片，分析线条复杂程度</p>\n</li>\n<li>\n<p>若复杂程度超过一个特定的值 h，归为数码宝贝</p>\n</li>\n<li>\n<p>若复杂程度小于特定值 h， 归为宝可梦</p>\n</li>\n<li>\n<p>将 h 所有的可能性集合起来，得到 H={1，2，……，10000}  <span class=\"spoiler\" title=\"好奇心害死猫\">h 可能是 1，2……</span></p>\n</li>\n<li>\n<p>H 内可能的 h 的数量即模型的<ins>复杂程度</ins></p>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"定一个损失-loss\"><a class=\"anchor\" href=\"#定一个损失-loss\">#</a> 定一个损失 Loss</h2>\n<ol>\n<li>\n<p>给出一个<mark>数据集</mark>，数据集中有<ins>成对</ins>的输入<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 与输出<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 即数据集中精灵的图片</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 即数据集中<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 对应的精灵的类别 label</li>\n</ul>\n</li>\n<li>\n<p>根据数据集求损失值 L</p>\n<ul>\n<li>\n<p>根据每一对数据算得一个单个损失值<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>， <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 越大，表现越差，反之表现越好</p>\n<details><summary>求一对数据损失值l的方法</summary><div>\n<p>在此有很多解决办法，最简单直观的：</p>\n<ul>\n<li>若将<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和给定 h 值输入到函数中，若得到相应的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 0</li>\n<li>若得到的结果不匹配，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 1</li>\n<li>比如：!! 输入一个宝可梦的照片<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>， 输出的结果<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 “数码宝贝”，则<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 1，若输出结果为 “宝可梦” 则<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>l</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">l_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 0!</li>\n</ul>\n</div></details>\n</li>\n<li>\n<p>将所有组得到的 l 求和取平均获取最终损失值 L</p>\n</li>\n</ul>\n</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.15999999999999992em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>l</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msup><mi>x</mi><mi>n</mi></msup><mo separator=\"true\">,</mo><msup><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\"> \\begin {array}{c}\n\nL = \\frac1 N \\sum_{n=1}^N l(h, x^n, \\hat y^n )\n\n\\end{array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.341231em;vertical-align:-0.4206155em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9206155em;\"><span style=\"top:-2.9393845em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.981231em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.69444em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4206155em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<h2 id=\"训练样例选择\"><a class=\"anchor\" href=\"#训练样例选择\">#</a> 训练样例选择</h2>\n<blockquote train=\"\">\n<p>找到一个具有代表性的数据集D_</p>\n</blockquote>\n<p>理想情况下，如果收集所有的宝可梦和数码宝贝的图片作数据集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{all}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，就能得到最好的 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">h^{all}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span></span></span></span> :</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>h</mi></msub><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h^{all} =  argmin_h L(h, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> <span class=\"spoiler\" title=\"好奇心害死猫\">即<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">h^{all}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span></span></span></span>  = 可以让 L 取到最小的 h</span></li>\n</ul>\n<p>现实中，我们不可能收集到所有的数码宝贝与宝可梦，只能收集到一部分图片作为数据集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> ，从<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 得到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">h^{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.824664em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span></span> :</p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>h</mi></msub><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h^{train} = argmin_h L(h, D_{train})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.824664em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">i</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></li>\n</ul>\n<blockquote>\n<p>我们希望<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{train}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0746639999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 与 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all},D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 是接近的，也就是现实的损失值接近于理想的损失值，即 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>δ</mi></mrow><annotation encoding=\"application/x-tex\">L(h^{train}, D_{all}) - L(h^{all},D_{all})≤ \\delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0746639999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span></span></span></span> ，那么什么样的数据集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 可以满足这种情况呢？</p>\n</blockquote>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∀</mi><mi>h</mi><mo>∈</mo><mi>H</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∣</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><mi>δ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\forall h \\in H, | L(h, D_{train})  - L(h, D_{all}) | ≤  \\delta / 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span class=\"mord\">∀</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span> , 通常将<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\delta / 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span> 。对所有可能的 h 而言，从数据集中算得的损失与所有的数据集中算的的损失差距小于等与<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\delta / 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span>，则可以得到我们想要的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{train}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0746639999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 与 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all},D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 相接近。</p>\n<h2 id=\"抽样到不好的样本的可能性\"><a class=\"anchor\" href=\"#抽样到不好的样本的可能性\">#</a> 抽样到不好的样本的可能性</h2>\n<p>怎样定义一个坏的一个训练集<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: 它肯定满足 ” 存在至少一个 h，使得 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo>&gt;</mo><mi>δ</mi><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">L(h, D_{train})  - L(h, D_{all}) | &gt;  \\delta / 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">/</span><span class=\"mord\">2</span></span></span></span>“</p>\n<p>坏样本的概率 = 在 H 的范围内，由于<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 导致样本坏的概率 的合集，也就约等于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 导致样本坏的概率求和，即：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.15999999999999992em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>⋃</mo><mstyle scriptlevel=\"1\"><mtable rowspacing=\"0.1em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"1\" displaystyle=\"false\"><mrow><mi>h</mi><mo>∈</mo><mi>H</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></msub><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mtext> </mtext><mi>d</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mi>t</mi><mi>o</mi><mtext> </mtext><mi>h</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><msub><mo>∑</mo><mstyle scriptlevel=\"1\"><mtable rowspacing=\"0.1em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"1\" displaystyle=\"false\"><mrow><mi>h</mi><mo>∈</mo><mi>H</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></msub><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mtext> </mtext><mi>d</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mi>t</mi><mi>o</mi><mtext> </mtext><mi>h</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\"> \\begin {array}{c}\n\nP(D_{train} \\ is \\ bad) = \\bigcup_{\\substack{h \\in H}} P(D_{train} \\ is \\ bad \\ due \\ to \\ h)  \\leq \\sum_{\\substack{h \\in H}} P(D_{train} \\ is \\ bad  \\ due \\ to \\ h)  \n\n\\end{array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2707640000000002em;vertical-align:-0.385382em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8853820000000002em;\"><span style=\"top:-3.045382em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">⋃</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18134399999999984em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6872199999999999em;\"><span style=\"top:-2.6927800000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18722000000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43076400000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18134399999999984em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6872199999999999em;\"><span style=\"top:-2.6927800000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18722000000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43076400000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.385382em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<details class=\"info\"><summary>如何算得L(h, D<sub>all</sub>)?</summary><div>\n<p>在所有可以收集到的资料上计算<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msup><mi>x</mi><mi>n</mi></msup><mo separator=\"true\">,</mo><msup><mi>y</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">l(h, x^n, y^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>，求和取平均就能得到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n</div></details>\n<details class=\"info\"><summary>如何算得L(h, D<sub>train</sub>)?</summary><div>\n<p>从所有资料中取样出一些数据集。计算<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msup><mi>x</mi><mi>n</mi></msup><mo separator=\"true\">,</mo><msup><mi>y</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">l(h, x^n, y^n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>，求和取平均就能得到<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h, D_{train})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n</div></details>\n<h3 id=\"hoeffdings-inequality\"><a class=\"anchor\" href=\"#hoeffdings-inequality\">#</a> Hoeffding's inequality</h3>\n<blockquote>\n<p>霍夫丁不等式给出了随机变量的和与其期望值偏差的概率上限</p>\n</blockquote>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.15999999999999992em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mtext> </mtext><mi>d</mi><mi>u</mi><mi>e</mi><mtext> </mtext><mi>t</mi><mi>o</mi><mtext> </mtext><mi>h</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mn>2</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>N</mi><msup><mi>ε</mi><mn>2</mn></msup></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\"> \\begin {array}{c}\n\n P(D_{train} \\ is \\ bad  \\ due \\ to \\ h) \\leq 2 e^{-2N \\varepsilon ^2} \n\n\\end{array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.34692em;vertical-align:-0.42346em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.92346em;\"><span style=\"top:-2.93654em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">o</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869199999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ε</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913142857142857em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.42346em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<ul>\n<li>L 的范围是 [0,1]</li>\n<li>N 是<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 中训练资料的数目</li>\n</ul>\n<p>所以可以得出获得的<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">D_{train}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是坏的概率为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.15999999999999992em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><msub><mo>∑</mo><mstyle scriptlevel=\"1\"><mtable rowspacing=\"0.1em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"1\" displaystyle=\"false\"><mrow><mi>h</mi><mo>∈</mo><mi>H</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></msub><mn>2</mn><msup><mi>e</mi><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>2</mn><mi>N</mi><msup><mi>ε</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>H</mi><mi mathvariant=\"normal\">∣</mi><mo>⋅</mo><mn>2</mn><msup><mi>e</mi><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>2</mn><mi>N</mi><msup><mi>ε</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\"> \\begin {array}{c}\n\nP(D_{train} \\ is \\ bad) \\leq \\sum_{\\substack{h \\in H}} 2 e^{(-2N \\varepsilon ^2)}    = |H|\\cdot 2 e^ {(-2N \\varepsilon ^2)} \n\n\\end{array}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.417684em;vertical-align:-0.45884199999999986em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9588420000000001em;\"><span style=\"top:-2.971922em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18134399999999984em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6872199999999999em;\"><span style=\"top:-2.6927800000000004em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mrel mtight\">∈</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.08125em;\">H</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.18722000000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.43076400000000004em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869199999999998em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ε</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913142857142857em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869199999999998em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ε</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913142857142857em;\"><span style=\"top:-2.931em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.45884199999999986em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<p>由此，让<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>b</mi><mi>a</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(D_{train} \\ is \\ bad)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span> 变小，可以增大 N 或者缩小 | H|。</p>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">也就是取得样本集中样本越多，h 取值值范围越小，该集合是坏的概率越低</span></p>\n<details class=\"info\"><summary>若h是连续的，那怎么确定|H|？</summary><div>\n<ul>\n<li>答案 1：计算机中所有数据都是离散的</li>\n<li>答案 2：VC-dimension，一种描述模型复杂程度的指标</li>\n</ul>\n</div></details>\n<p>为了达到理想的情况，我们可以增大 N 或缩小 | H|，此时会面临另外两种问题</p>\n<ul>\n<li>收集训练资料时，N 是很难控制的</li>\n<li>缩小 h 的范围，很难找到最合适的 h 值\n<ul>\n<li>若 | H | 较大，则<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 会较小，也就是理想情况下损失较小，导致<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{train}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0746639999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 与<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的差距明显，理想情况下与现实情况有较明显的差距</li>\n<li>若 | H | 较小，则<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 会较大，也就是理想情况下损失较大，导致<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{train}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0746639999999998em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 与<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msup><mo separator=\"true\">,</mo><msub><mi>D</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">L(h^{all}, D_{all})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 的差距较小，理想情况下与现实情况差距不明显</li>\n</ul>\n</li>\n</ul>\n<p>如何解决这个问题？ 鱼与熊掌能不能兼得？</p>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">可以，深度学习</span></p>\n",
            "tags": [
                "人工智能",
                "机器学习",
                "机器学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/ai/machine-learning/machine_course01/",
            "url": "https://crpdim.github.io/ai/machine-learning/machine_course01/",
            "title": "机器学习课程01-课程内容大纲",
            "date_published": "2023-03-28T16:00:00.000Z",
            "content_html": "<h1 id=\"机器学习课程01\"><a class=\"anchor\" href=\"#机器学习课程01\">#</a> 机器学习课程 01</h1>\n<h2 id=\"机器学习机器帮忙找函数\"><a class=\"anchor\" href=\"#机器学习机器帮忙找函数\">#</a> 机器学习 = 机器帮忙找函数</h2>\n<blockquote>\n<p>机器学习目的： 写一个人类写不出的复杂函数，实现人类想要的功能 1</p>\n</blockquote>\n<p>如：</p>\n<ul>\n<li>声音转文字： 输入音频信号，机器帮忙找到一个函数将音频信号转换为文字</li>\n<li>图片识别： 输入图片，机器帮忙找到一个函数将图片转换为文字</li>\n<li>AlphaGo： 输入棋盘黑白子位置，机器帮忙找到一个函数输出下一步落子位置</li>\n</ul>\n<blockquote>\n<p>深度学习： 机器学习找的函数是一个类神经网络</p>\n</blockquote>\n<h2 id=\"输入与输出\"><a class=\"anchor\" href=\"#输入与输出\">#</a> 输入与输出</h2>\n<blockquote>\n<p>机器学习的输入输出形式</p>\n</blockquote>\n<ul>\n<li>输入形式有：序列 (Sequence)、向量 (Vector)、矩阵 (Matrix)</li>\n<li>输出形式有：数值 (Regression)、类别 (Classification)、文档</li>\n</ul>\n<h2 id=\"如何训练机器\"><a class=\"anchor\" href=\"#如何训练机器\">#</a> 如何训练机器</h2>\n<blockquote>\n<p>怎样让机器分辨宝可梦和数码宝贝？</p>\n</blockquote>\n<h3 id=\"训练步骤\"><a class=\"anchor\" href=\"#训练步骤\">#</a> 训练步骤</h3>\n<ol>\n<li>收集训练数据：收集很多数码宝贝和宝可梦的图片</li>\n<li>标注数据类型：标注图片的 label</li>\n<li>将<ins>输入与对应的 label</ins> 交给机器：让机器自己找出能分辨数码宝贝和宝可梦的函数（输入精灵图片，输出类别）</li>\n</ol>\n<h3 id=\"self-supervised-learning\"><a class=\"anchor\" href=\"#self-supervised-learning\">#</a> Self-supervised Learning</h3>\n<blockquote>\n<p>收集数据会花费大量时间，且有很多相似但不同的任务怎么办？如：识别宝可梦和数码宝贝与识别猫和狗。</p>\n</blockquote>\n<p>在训练之前练就基本功：(Pre-train) 即基本模型，就可以在这基础上很快适应其他任务。</p>\n<h3 id=\"generative-adversarial-network\"><a class=\"anchor\" href=\"#generative-adversarial-network\">#</a> Generative Adversarial Network</h3>\n<blockquote>\n<p>生成对抗网络，让机器自己学习生成数据</p>\n</blockquote>\n<p>只需要收集大量输入与大量输出，输入与输出之间<ins>不需要成对的关系</ins>，机器就能自动找出对应关系。</p>\n<h3 id=\"reinforcement-learning\"><a class=\"anchor\" href=\"#reinforcement-learning\">#</a> Reinforcement Learning</h3>\n<blockquote>\n<p>强化学习，让机器自己学习做任务</p>\n</blockquote>\n<p>机器学习的另一种方式，不需要输入与输出，只需要输入与奖励，机器就能自动找出对应关系。</p>\n<h2 id=\"异常检测-anomaly-detection\"><a class=\"anchor\" href=\"#异常检测-anomaly-detection\">#</a> 异常检测 Anomaly Detection</h2>\n<blockquote>\n<p>让机器可以回答 “我不知道”</p>\n</blockquote>\n<p>如：训练出了一个宝可梦跟数码宝贝的分类器，但是给了它一张恐龙的图片，它可以说不知道。</p>\n<h2 id=\"explainable-ai\"><a class=\"anchor\" href=\"#explainable-ai\">#</a> Explainable AI</h2>\n<blockquote>\n<p>让机器不仅可以回答正确答案，还可以回答为什么</p>\n</blockquote>\n<p>给模型大量图片，让它解释图片中哪些地方是重要的。</p>\n<h2 id=\"模型攻击-model-attack\"><a class=\"anchor\" href=\"#模型攻击-model-attack\">#</a> 模型攻击 Model Attack</h2>\n<blockquote>\n<p>人类对模型的攻击</p>\n</blockquote>\n<p>如：让机器学习识别猫，给它一张猫的图片，但是在图片中加入一些噪声，让机器识别不出来。</p>\n<h2 id=\"network-compression\"><a class=\"anchor\" href=\"#network-compression\">#</a> Network Compression</h2>\n<blockquote>\n<p>让模型更小，更快</p>\n</blockquote>\n<p>一个巨大的模型很难在正常设备中运行，通过很多技术让模型变小，让这些模型可以在常见设备中运行。</p>\n<h2 id=\"life-long-learning\"><a class=\"anchor\" href=\"#life-long-learning\">#</a> Life-Long Learning</h2>\n<blockquote>\n<p>让机器不断学习，及将机器训练成天网所面临的挑战</p>\n</blockquote>\n<h2 id=\"meta-learning\"><a class=\"anchor\" href=\"#meta-learning\">#</a> Meta Learning</h2>\n<blockquote>\n<p>让机器学习 &quot;<ins> 如何学习</ins> &quot;</p>\n</blockquote>\n<p>让机器从大量任务中发明新的算法，从过往经验学习新的算法</p>\n<h3 id=\"few-shot-learning\"><a class=\"anchor\" href=\"#few-shot-learning\">#</a> Few-Shot Learning</h3>\n<blockquote>\n<p>用少量的标注资料学习</p>\n</blockquote>\n",
            "tags": [
                "人工智能",
                "机器学习",
                "机器学习"
            ]
        },
        {
            "id": "https://crpdim.github.io/computer-science/programming-language/python/pyqt5_m1/",
            "url": "https://crpdim.github.io/computer-science/programming-language/python/pyqt5_m1/",
            "title": "M1安装pyqt5",
            "date_published": "2022-09-20T12:46:25.000Z",
            "content_html": "<h1 id=\"m1安装pyqt5\"><a class=\"anchor\" href=\"#m1安装pyqt5\">#</a> M1 安装 pyqt5</h1>\n<blockquote>\n<p>在 m1 上无法使用 pip 安装 pyqt5，总结一下安装经验</p>\n</blockquote>\n<h2 id=\"1-用homebrew安装-qt-sip-pyqt5\"><a class=\"anchor\" href=\"#1-用homebrew安装-qt-sip-pyqt5\">#</a> 1. 用 Homebrew 安装 qt、sip、PyQt5</h2>\n<h3 id=\"终端中输入\"><a class=\"anchor\" href=\"#终端中输入\">#</a> 终端中输入</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>brew <span class=\"token function\">install</span> qt</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>brew <span class=\"token function\">install</span> sip</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>brew <span class=\"token function\">install</span> pyqt5</pre></td></tr></table></figure><h3 id=\"检查安装情况\"><a class=\"anchor\" href=\"#检查安装情况\">#</a> 检查安装情况：</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>brew list</pre></td></tr></table></figure><h2 id=\"2-找到刚安装的pyqt5的库文件\"><a class=\"anchor\" href=\"#2-找到刚安装的pyqt5的库文件\">#</a> 2. 找到刚安装的 pyqt5 的库文件</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 库文件所在位置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/opt/homebrew/Cellar/pyqt@5/5.15.7_2/lib/python3.9/site-packages</pre></td></tr></table></figure><h2 id=\"3-将site-packages中的文件复制到python环境\"><a class=\"anchor\" href=\"#3-将site-packages中的文件复制到python环境\">#</a> 3. 将 site-packages 中的文件复制到 python 环境</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#我使用 miniforge 创建的 python 虚拟环境所在位置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/Users/crpdim/miniforge3/envs/MyEnv/lib/python3.9/site-packages</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>使用cp命令将pyqt5库文件复制到python环境</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">cp</span> <span class=\"token parameter variable\">-r</span> /opt/homebrew/Cellar/pyqt@5/5.15.7_2/lib/python3.9/site-packages/. /opt/homebrew/Cellar/pyqt@5/5.15.7_2/lib/python3.9/site-packages</pre></td></tr></table></figure><h2 id=\"4-检查是否能正常使用\"><a class=\"anchor\" href=\"#4-检查是否能正常使用\">#</a> 4. 检查是否能正常使用</h2>\n<p><code>import PyQt5</code>  没发生异常则表示能 <span class=\"spoiler\" title=\"好奇心害死猫\">正常使用</span><br />\n<span class=\"label success\">✔️success</span></p>\n<div class=\"note success\">\n<p>成功啦</p>\n</div>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_0\"> 红叉叉</label></li>\n</ul>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span>MyEnv<span class=\"token punctuation\">)</span> crpdim@MyComputer ~ %python</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Python <span class=\"token number\">3.9</span>.16 <span class=\"token punctuation\">(</span>main, Mar  <span class=\"token number\">8</span> <span class=\"token number\">2023</span>, 04:29:24<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>Clang <span class=\"token number\">14.0</span>.6 <span class=\"token punctuation\">]</span> :: Anaconda, Inc. on darwin</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Type <span class=\"token string\">\"help\"</span>, <span class=\"token string\">\"copyright\"</span>, <span class=\"token string\">\"credits\"</span> or <span class=\"token string\">\"license\"</span> <span class=\"token keyword\">for</span> <span class=\"token function\">more</span> information.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token function\">import</span> PyQt5</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">>></span><span class=\"token operator\">></span></pre></td></tr></table></figure>",
            "tags": [
                "计算机科学",
                "编程语言",
                "Python",
                "Python"
            ]
        },
        {
            "id": "https://crpdim.github.io/note/docker/",
            "url": "https://crpdim.github.io/note/docker/",
            "title": "Docker学习",
            "date_published": "2022-06-27T12:46:25.000Z",
            "content_html": "<h1 id=\"docker\"><a class=\"anchor\" href=\"#docker\">#</a> Docker</h1>\n<blockquote>\n<p>将硬件资源比作开发商拥有的一块地，那么物理机就可以看作一栋别墅，而虚拟机则可以看做楼房，容器的作用则相当于在房间中进行隔断，可以最大化利用资源。</p>\n</blockquote>\n<h2 id=\"虚拟化\"><a class=\"anchor\" href=\"#虚拟化\">#</a> 虚拟化</h2>\n<p>虚拟化 (英语：Virtualization) 是一种资源管理技术，是将计算机的各种实体资源，如服 务器、网络、内存及存储等，予以抽象、转换后呈现出来，<strong>打破实体结构间的不可切割的障碍，使用户可以比原本的组态更好的方式来应用这些资源</strong>。这些资源的新虚拟部份是不受现有资源的架设方式，地域或物理组态所限制。一般所指的虚拟化资源包括计算能力和资料存储。</p>\n<h2 id=\"docker-2\"><a class=\"anchor\" href=\"#docker-2\">#</a> Docker</h2>\n<blockquote>\n<p>Docker 是一个开发，运输和运行应用程序的开放平台。 Docker 使您可以将应用程序与基础架构分离， 以便快速交付软件。</p>\n</blockquote>\n<h3 id=\"优点\"><a class=\"anchor\" href=\"#优点\">#</a> 优点</h3>\n<p>使用 Docker，您可以像管理应用程序一样管理<strong>基础架构</strong> (OS)。 通过利用 Docker 的方法快速发送，测试和部署代码，您可以显着减少编写代码和在生产中运行代码之间的延迟。</p>\n<p>容器提供了隔离性，结论是，容器可以为各种测试提供很好的<strong>沙盒环境</strong>。并且，容器本身就具有 “标准性” 的特征，非常适合为服务创建构建块。Docker 的一些应用场景如下:</p>\n<ul>\n<li>加速本地开发和构建流程，使其更加高效、更加轻量化。本地开发人员可以构建、运行并分享 Docker 容器。容器可以在开发环境中构建，然后轻松的提交到测试环境中，并最终进入生产环 境。 开发人员与运维人员进行职责的逻辑分离</li>\n<li>能够让独立的服务或应用程序在不同的环境中，得到相同的运行结果。这一点在面向服务的架构和 重度依赖微型服务的部署由其实用。</li>\n<li>用 Docker 创建隔离的环境来进行测试。例如，用 Jenkins CI 这样的持续集成工具启动一个用于测试 的容器。(持续化集成 war 实际部署:jenkins 持续化集成 Jenkins + git)</li>\n<li>Docker 可以让开发者先在本机上构建一个复杂的程序或架构来进行测试，而不是一开始就在生产 环境部署、测试。</li>\n<li>构建一个多用户的平台即服务 (<strong>PaaS</strong>) 基础设施</li>\n<li>为开发、测试提供一个轻量级的独立的沙盒环境</li>\n<li>提供软件即服务 (SaaS) 应用程序，例如 Memcached 即服务</li>\n<li>高性能、超大规模的宿主机部署 (可以很多容器)</li>\n</ul>\n<blockquote>\n<p>沙盒：在计算机安全领域，沙盒 (英语:sandbox，又译为沙箱) 是一种安全机制，为运行中的程序提供的隔 离环境。通常是作为一些来源不可信、具破坏力或无法判定程序意图的程序提供实验之用。</p>\n</blockquote>\n<h3 id=\"集装箱思想\"><a class=\"anchor\" href=\"#集装箱思想\">#</a> 集装箱思想</h3>\n<p>Docker 借鉴了标准<strong>集装箱的概念</strong>。标准集装箱将货物运往世界各地，Dock 将这个模型运用到自己的设计中，唯一不同的是：集装箱运输货物，而 Docker 运输软件、应用程序。</p>\n<p>和集装箱一样，Docker 在执行上述操作时，<strong>并不关心容器中到底装了什么</strong>，它不管是 web 服务器，还是数据库，或者是应用程序服务器什么的。所有的容器都按照相同的方式将内容 “装载” 进去。</p>\n<p>Docker 也不关心你要把容器运到何方：我们可以在自己的笔记本中构建容器，上传到 Registry，然后下载到一个物理的或者虚拟的服务器来测试，在把容器部署到具体的主机中。像标准集装箱一样，Docker 容器方便替换，可以叠加，易于分发，并且尽量通用。</p>\n<h3 id=\"docker架构\"><a class=\"anchor\" href=\"#docker架构\">#</a> Docker 架构</h3>\n<p>三部分构成：Client、docker_host、Registry</p>\n<h4 id=\"client客户端用户操作-发送命令\"><a class=\"anchor\" href=\"#client客户端用户操作-发送命令\">#</a> Client（客户端）：用户操作 -&gt; 发送命令</h4>\n<ul>\n<li>docker build</li>\n<li>docker pull</li>\n<li>docker run</li>\n</ul>\n<h4 id=\"dockerhostdocker引擎解析客户端发送的命令\"><a class=\"anchor\" href=\"#dockerhostdocker引擎解析客户端发送的命令\">#</a> DOCKER—HOST（docker 引擎）：解析客户端发送的命令</h4>\n<p>分两部分：</p>\n<ul>\n<li>Image (镜像)：特殊文件叠加而成，镜像文件从镜像仓库中拉取。</li>\n<li>Containers (容器)：创建容器必须依赖镜像！</li>\n</ul>\n<h4 id=\"registry镜像仓库\"><a class=\"anchor\" href=\"#registry镜像仓库\">#</a> Registry（镜像仓库）</h4>\n<h2 id=\"docker命令\"><a class=\"anchor\" href=\"#docker命令\">#</a> Docker 命令</h2>\n<ul>\n<li>\n<p>docker 运行： <code>docker run 镜像名</code></p>\n</li>\n<li>\n<p>列出本地镜像 <code>docker images</code> ：列出镜像名、版本、id、建立时间、大小</p>\n</li>\n<li>\n<p>查找镜像： <code>docker search 镜像名</code></p>\n</li>\n<li>\n<p>拉取镜像： <code>docker pull 镜像名[:version]</code></p>\n<blockquote>\n<p>Docker 镜像首页，包括官方镜像和其它公开镜像。Docker Hub 上最受欢迎的 10 大镜像 (通过 Docker registry API 获取不了镜像被 pull 的个数，只能通过镜像的 stars 数量，来衡量镜像的流行度。毫无疑问， 拥有最高 stars 数量的库都是官方库。国情的原因，国内下载 Docker HUB 官方的相关镜像比较慢，可以使用国内 (<span class=\"exturl\" data-url=\"aHR0cDovL2RvY2tlci5pbw==\">docker.io</span>) 的一些镜像加速器，镜像保持和官方一致，关键是速度块，推荐使用。配置镜像加速器:</p>\n</blockquote>\n</li>\n<li>\n<p>删除镜像</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token number\">1</span>、删除一个镜像</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> rmi 镜像名/id</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2</span>、删除多个镜像</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">docker</span> rmi 镜像名1/id1 镜像名2/id2 <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">3</span>、删除所有镜像</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">docker</span> rmi <span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">docker</span> images <span class=\"token parameter variable\">-q</span><span class=\"token variable\">`</span></span></pre></td></tr></table></figure></li>\n<li>\n<p>创建容器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> image <span class=\"token builtin class-name\">command</span> <span class=\"token punctuation\">[</span>ARG<span class=\"token punctuation\">..</span>.<span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>创建交互式容器（exit 容器停止）</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-i</span> <span class=\"token parameter variable\">-t</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>c1 centos/bin/bash</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>创建守护式容器（exit 容器不停止）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>c2 centos/bin/bash</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>options选项: -i、-t、-d、--name</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>-i:交互式容器</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>-t:tty，终端<span class=\"token punctuation\">(</span>分配一个终端，操作容器<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>--name：指定容器名称</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>-d:后台运行，并且打印容器id</pre></td></tr></table></figure></li>\n<li>\n<p>进入容器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>方式一:</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> attach 容器名称/id  <span class=\"token punctuation\">(</span>ps:exit,容器停止<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>eg:docker attach u3</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>方式二:</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> 容器名称/id /bin/bash <span class=\"token punctuation\">(</span>ps:exit,容器不会停止<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>eg:docker <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> u3 /bin/bash</pre></td></tr></table></figure></li>\n<li>\n<p>查看容器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> ps:查看正在运行的容器</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> -a:查看运行过的容器<span class=\"token punctuation\">(</span>历史<span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> -l:最后一次运行的容器</pre></td></tr></table></figure></li>\n<li>\n<p>启动 / 停止容器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> start 容器名称/id </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> stop 容器名称/id</pre></td></tr></table></figure></li>\n<li>\n<p>获取容器 / 镜像元数据</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>查看容器/镜像全部信息: </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> inspect 容器/镜像</pre></td></tr></table></figure></li>\n<li>\n<p>删除容器</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>删除一个容器:</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">rm</span> 容器名/id</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>删除多个容器:</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">rm</span> 容器名1/id1 容器名2/id2 <span class=\"token punctuation\">..</span>.</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>删除所有容器</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">rm</span> <span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">-a</span> <span class=\"token parameter variable\">-q</span><span class=\"token variable\">`</span></span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>PS:无法删除正在运行的容器</pre></td></tr></table></figure></li>\n<li>\n<p>查看容器日志 <code>docker logs 容器名/id</code></p>\n</li>\n<li>\n<p>文件拷贝</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>如果我们需要将文件拷贝到容器内可以使用cp命令</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">cp</span> 需要拷贝的文件或目录 容器名:容器目录</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>例如:docker <span class=\"token function\">cp</span> <span class=\"token number\">1</span>.txt c2:/root</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>也可以将文件从容器内拷贝出来</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token function\">cp</span> 容器名:容器目录 需要拷贝的文件或目录 </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>例如:docker <span class=\"token function\">cp</span> c2:/root/2.txt /root</pre></td></tr></table></figure></li>\n<li>\n<p>目录挂载</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>我们可以在创建容器的时候，将宿主机的目录与容器内的目录进行映射，这样我们就可以通过修改宿主</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>机某个目录的文件从而去影响容器。创建容器 添加-v参数 后边为 宿主机目录:容器目录</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> run <span class=\"token parameter variable\">-id</span> <span class=\"token parameter variable\">--name</span><span class=\"token operator\">=</span>c4 <span class=\"token parameter variable\">-v</span> /opt/:/usr/local/myhtml centos</pre></td></tr></table></figure></li>\n</ul>\n",
            "tags": [
                "技能学习",
                "docker"
            ]
        },
        {
            "id": "https://crpdim.github.io/computer-science/net/Net/",
            "url": "https://crpdim.github.io/computer-science/net/Net/",
            "title": "计算机网络体系结构",
            "date_published": "2022-06-20T12:46:25.000Z",
            "content_html": "<h1 id=\"计算机体系结构\"><a class=\"anchor\" href=\"#计算机体系结构\">#</a> 计算机体系结构</h1>\n<p>计算机网络定义： 互联的自治的计算机系统集合。</p>\n<h3 id=\"计算机网络组成\"><a class=\"anchor\" href=\"#计算机网络组成\">#</a> 计算机网络组成</h3>\n<p>由组成成分分：硬件、软件、协议</p>\n<p>由工作方式： 核心部分、边缘部分</p>\n<p>由功能组成： 资源子网、通信子网</p>\n<h3 id=\"计算机网络功能\"><a class=\"anchor\" href=\"#计算机网络功能\">#</a> 计算机网络功能：</h3>\n<ol>\n<li>数据通信</li>\n<li>资源共享</li>\n<li>分布式处理</li>\n<li>提高可靠性</li>\n<li>负载均衡</li>\n</ol>\n<h3 id=\"计算机网络分类\"><a class=\"anchor\" href=\"#计算机网络分类\">#</a> 计算机网络分类：</h3>\n<h4 id=\"按分布范围\"><a class=\"anchor\" href=\"#按分布范围\">#</a> 按分布范围：</h4>\n<ul>\n<li>广域网 WAN</li>\n<li>城域网 MAN</li>\n<li>局域网 LAN</li>\n<li>个域网 PAN</li>\n</ul>\n<h4 id=\"按传输技术\"><a class=\"anchor\" href=\"#按传输技术\">#</a> 按传输技术：</h4>\n<ul>\n<li>广播式网络</li>\n<li>点对点网络  （分组存储转发和路由选择机制）</li>\n</ul>\n<h4 id=\"按拓扑结构\"><a class=\"anchor\" href=\"#按拓扑结构\">#</a> 按拓扑结构：</h4>\n<ul>\n<li>总线型</li>\n<li>星型</li>\n<li>网状型</li>\n<li>环形</li>\n</ul>\n<h4 id=\"按使用者\"><a class=\"anchor\" href=\"#按使用者\">#</a> 按使用者：</h4>\n<ul>\n<li>公用网</li>\n<li>专用网</li>\n</ul>\n<h4 id=\"按交换技术\"><a class=\"anchor\" href=\"#按交换技术\">#</a> 按交换技术</h4>\n<ul>\n<li>电路交换网络</li>\n<li>报文交换网络</li>\n<li>分组交换网络</li>\n</ul>\n<h4 id=\"按传输介质\"><a class=\"anchor\" href=\"#按传输介质\">#</a> 按传输介质</h4>\n<ol>\n<li>有线： （双绞线、同轴电缆等）</li>\n<li>无线：（微波、蓝牙、无线电等）</li>\n</ol>\n<h3 id=\"性能指标\"><a class=\"anchor\" href=\"#性能指标\">#</a> 性能指标</h3>\n<ul>\n<li>\n<p>带宽：信道最高传输速率 (b/s)</p>\n</li>\n<li>\n<p>时延：数据从一端传送到另一端所需总时间</p>\n<ul>\n<li>发送时延</li>\n<li>传播时延</li>\n<li>处理时延</li>\n</ul>\n</li>\n<li>\n<p>时延带宽积： 发送端的第一个比特即将到达终点时，发送端已经发送了多少个比特</p>\n<p>时延带宽积 = 传播时延 x 信道带宽</p>\n</li>\n<li>\n<p>往返时延 RTT：发送端发送一个短分组到发送端收到来自接收端的确认（包括中间节点的处理时延、排队时延、以及转发数据的发送时延）</p>\n</li>\n<li>\n<p>吞吐量： 单位时间内通过某网络的数据量</p>\n</li>\n<li>\n<p>速率：数据传输速率、数据率、比特率 单位 (b/s)</p>\n</li>\n<li>\n<p>信道利用率： 信道有数据通过时间 ÷ (有 + 无) 数据通过时间</p>\n</li>\n</ul>\n<h2 id=\"计算机网络分层结构与参考模型\"><a class=\"anchor\" href=\"#计算机网络分层结构与参考模型\">#</a> 计算机网络分层结构与参考模型</h2>\n<h3 id=\"分层结构\"><a class=\"anchor\" href=\"#分层结构\">#</a> 分层结构</h3>\n<h4 id=\"分层原因\"><a class=\"anchor\" href=\"#分层原因\">#</a> 分层原因：</h4>\n<p>降低协议设计和调试的复杂性、方便对网络进行研究、实现和维护</p>\n<h4 id=\"分层原则\"><a class=\"anchor\" href=\"#分层原则\">#</a> 分层原则</h4>\n<ol>\n<li>每层都实现相对独立的功能，降低大系统复杂度</li>\n<li>各层之间界面自然清晰、易于理解、相互交流少</li>\n<li>各层功能的精确定义独立于具体实现方法、可以采用最合适的技术实现</li>\n<li>保持下层对上层的独立性、上层单向使用下层服务</li>\n<li>整个分层结构应能促进标准化工作</li>\n</ol>\n",
            "tags": [
                "计算机科学",
                "计算机网络",
                "计算机网络"
            ]
        },
        {
            "id": "https://crpdim.github.io/computer-science/net/RIP/",
            "url": "https://crpdim.github.io/computer-science/net/RIP/",
            "title": "RIP协议",
            "date_published": "2022-05-13T12:46:25.000Z",
            "content_html": "<h1 id=\"rip\"><a class=\"anchor\" href=\"#rip\">#</a> RIP</h1>\n<h2 id=\"rip-2\"><a class=\"anchor\" href=\"#rip-2\">#</a> RIP</h2>\n<blockquote>\n<p>应用层协议，使用 UDP 传送数据，520 端口</p>\n</blockquote>\n<h3 id=\"规定\"><a class=\"anchor\" href=\"#规定\">#</a> 规定</h3>\n<ol>\n<li>网络中每个路由器都要维护从自身到每个目的网络的距离纪录。</li>\n<li>路由器到直连网络的距离为 1。</li>\n<li>允许一条路径最多包含十五个路由器（距离为 16 表示网络不可达）。</li>\n<li>任意两个 RIP 路由器之间每 30s 广播一次 RIP 路由信息。</li>\n<li>不支持子网掩码的 RIP 广播。</li>\n</ol>\n<h3 id=\"特点\"><a class=\"anchor\" href=\"#特点\">#</a> 特点</h3>\n<ol>\n<li>仅和相邻路由器交换信息。</li>\n<li>路由器交换的信息为自己完整的路由表。</li>\n<li>按固定时间交换路由信息。</li>\n</ol>\n<h4 id=\"缺点\"><a class=\"anchor\" href=\"#缺点\">#</a> 缺点</h4>\n<ol>\n<li>限制了网络规模</li>\n<li>路由器间交换完整地路由表，网络规模越大，开销越大</li>\n<li>网络出现问题，会出现慢收敛情况</li>\n</ol>\n<h3 id=\"距离向量算法\"><a class=\"anchor\" href=\"#距离向量算法\">#</a> 距离向量算法</h3>\n<p>每个路由表项目包含三个关键数据 | 目的网络 N | 距离 d | 下一跳地址 X|</p>\n<p>对相邻的路由器发送过来的 RIP 报文：</p>\n<ol>\n<li>\n<p>地址为 X 的相邻路由器发送过来的 RIP 报文，先修改报文中的所有项目，将下一条地址改为 X，把所有距离字段 + 1。</p>\n</li>\n<li>\n<p>对修改后的每个项目：</p>\n<ol>\n<li>原来路由表中没有目的网络 N，将该项目添加到路由表中。</li>\n<li>原来路由表中有目的网络 N，且下一条地址为 X，则替换本地路由表项目。</li>\n<li>原来路由表中有目的网络 N，且下一条地址不是 X，若收到的项目中距离字段小于本地路由表到该网络的距离字段，则替换原来的表项。</li>\n</ol>\n</li>\n<li>\n<p>若超过 180s 没收到相邻路由器的更新路由表，将此相邻路由器标记位不可达。</p>\n</li>\n<li>\n<p>返回</p>\n</li>\n</ol>\n",
            "tags": [
                "计算机科学",
                "计算机网络",
                "计算机网络"
            ]
        },
        {
            "id": "https://crpdim.github.io/computer-science/linux/Tmux/",
            "url": "https://crpdim.github.io/computer-science/linux/Tmux/",
            "title": "Tmux简单使用",
            "date_published": "2022-04-12T12:46:25.000Z",
            "content_html": "<h1 id=\"tmux\"><a class=\"anchor\" href=\"#tmux\">#</a> Tmux</h1>\n<h2 id=\"作用\"><a class=\"anchor\" href=\"#作用\">#</a> 作用</h2>\n<blockquote>\n<p>将窗口与会话彻底分离</p>\n</blockquote>\n<ul>\n<li>允许在单个窗口中，同时访问多个会话。这对于同时运行多个命令行程序很有用。</li>\n<li>可以让新窗口 &quot;接入&quot; 已经存在的会话。</li>\n<li>允许每个会话有多个连接窗口，因此可以多人实时共享会话。</li>\n<li>支持窗口任意的垂直和水平拆分。</li>\n</ul>\n<h2 id=\"用法\"><a class=\"anchor\" href=\"#用法\">#</a> 用法</h2>\n<h3 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># Ubuntu 或 Debian</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> tmux</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># Mac</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ brew <span class=\"token function\">install</span> tmux</pre></td></tr></table></figure><h3 id=\"启动\"><a class=\"anchor\" href=\"#启动\">#</a> 启动</h3>\n<p>输入 tmux 启动 Tmux 窗口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ tmux</pre></td></tr></table></figure><p><img data-src=\"https://github.com/Crpdim/crpdim.github.io/raw/main/tmux_1.png\" alt=\"uTools_1665966015180\" /></p>\n<h3 id=\"退出\"><a class=\"anchor\" href=\"#退出\">#</a> 退出</h3>\n<p>ctrl+d 或者输入 exit 命令就能退出 Tmux 窗口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token builtin class-name\">exit</span></pre></td></tr></table></figure><h2 id=\"会话管理\"><a class=\"anchor\" href=\"#会话管理\">#</a> 会话管理</h2>\n<p>直接使用 <code> tmux</code>  命令建立新会话，窗口名称会从 0 依次往后增加，使用编号区分会话不直观，可以直接用以下命令为会话取名</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ tmux new <span class=\"token parameter variable\">-s</span> session_name</pre></td></tr></table></figure><h3 id=\"会话分离\"><a class=\"anchor\" href=\"#会话分离\">#</a> 会话分离</h3>\n<p>在 Tmux 窗口中，按下 <code>Ctrl+b d</code>  或者输入 <code>tmux detach</code>  命令，就会将当前会话与窗口分离。</p>\n<p>被分离的会话和里面的进程会在后台执行，使用 <code>tmux ls</code>  命令可以查看所有 tmux 会话</p>\n<h3 id=\"会话接入\"><a class=\"anchor\" href=\"#会话接入\">#</a> 会话接入</h3>\n<p><code>tmux attach</code>  命令用于重新接入某个已存在的会话。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 使用会话编号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux attach <span class=\"token parameter variable\">-t</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 使用会话名称</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ tmux attach <span class=\"token parameter variable\">-t</span> session-name</pre></td></tr></table></figure></blockquote>\n<h3 id=\"会话杀死\"><a class=\"anchor\" href=\"#会话杀死\">#</a> 会话杀死</h3>\n<p>在 Tmux 窗口中，按下 <code>Ctrl+b x</code>  或 <code>Ctrl+d</code>  可以杀死当前会话</p>\n<p>使用 <code>tmux kill-session</code>  命令用于杀死某个会话。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 使用会话编号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux kill-session <span class=\"token parameter variable\">-t</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 使用会话名称</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ tmux kill-session <span class=\"token parameter variable\">-t</span> <span class=\"token operator\">&lt;</span>session-name<span class=\"token operator\">></span></pre></td></tr></table></figure></blockquote>\n<h3 id=\"会话切换\"><a class=\"anchor\" href=\"#会话切换\">#</a> 会话切换</h3>\n<p><code>tmux switch</code>  命令用于切换会话。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 使用会话编号</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux switch <span class=\"token parameter variable\">-t</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 使用会话名称</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$ tmux switch <span class=\"token parameter variable\">-t</span> <span class=\"token operator\">&lt;</span>session-name<span class=\"token operator\">></span></pre></td></tr></table></figure></blockquote>\n<h3 id=\"会话重命名\"><a class=\"anchor\" href=\"#会话重命名\">#</a> 会话重命名</h3>\n<p><code>tmux rename-session</code>  命令用于重命名会话。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ tmux rename-session <span class=\"token parameter variable\">-t</span> <span class=\"token number\">0</span> new_name</pre></td></tr></table></figure></blockquote>\n<h2 id=\"窗格管理\"><a class=\"anchor\" href=\"#窗格管理\">#</a> 窗格管理</h2>\n<p><code>tmux split-window</code>  命令用来划分窗格。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 划分上下两个窗格</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux split-window</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 划分左右两个窗格</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>$ tmux split-window <span class=\"token parameter variable\">-h</span></pre></td></tr></table></figure></blockquote>\n<p><img data-src=\"https://github.com/Crpdim/crpdim.github.io/raw/main/tmux_2.png\" alt=\"image-20221017084655134\" /></p>\n<h2 id=\"移动光标\"><a class=\"anchor\" href=\"#移动光标\">#</a> 移动光标</h2>\n<p><code>tmux select-pane</code>  命令用来移动光标位置。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 光标切换到上方窗格</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux select-pane <span class=\"token parameter variable\">-U</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 光标切换到下方窗格</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$ tmux select-pane <span class=\"token parameter variable\">-D</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 光标切换到左边窗格</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>$ tmux select-pane <span class=\"token parameter variable\">-L</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># 光标切换到右边窗格</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>$ tmux select-pane <span class=\"token parameter variable\">-R</span></pre></td></tr></table></figure></blockquote>\n<h2 id=\"交换窗格位置\"><a class=\"anchor\" href=\"#交换窗格位置\">#</a> 交换窗格位置</h2>\n<p><code>tmux swap-pane</code>  命令用来交换窗格位置。</p>\n<blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 当前窗格上移</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$ tmux swap-pane <span class=\"token parameter variable\">-U</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 当前窗格下移</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>$ tmux swap-pane <span class=\"token parameter variable\">-D</span></pre></td></tr></table></figure></blockquote>\n<h2 id=\"其余快捷键\"><a class=\"anchor\" href=\"#其余快捷键\">#</a> 其余快捷键</h2>\n<p>使用 <code>Ctrl+b ?</code>  快捷键可以获取所有 tmux 快捷键</p>\n",
            "tags": [
                "计算机科学",
                "Linux学习",
                "linux"
            ]
        },
        {
            "id": "https://crpdim.github.io/computer-science/programming-language/cpp/week-1/",
            "url": "https://crpdim.github.io/computer-science/programming-language/cpp/week-1/",
            "title": "001Test",
            "date_published": "2020-04-12T12:46:25.000Z",
            "content_html": "<h1 id=\"c-day-01\"><a class=\"anchor\" href=\"#c-day-01\">#</a> C++ Day-01</h1>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>scanner</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"hello world!\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure>",
            "tags": [
                "计算机科学",
                "编程语言",
                "C++",
                "C++"
            ]
        },
        {
            "id": "https://crpdim.github.io/%E6%A8%A1%E7%89%88/",
            "url": "https://crpdim.github.io/%E6%A8%A1%E7%89%88/",
            "title": "blog模版",
            "date_published": "2019-07-25T08:43:00.000Z",
            "content_html": "<h1 id=\"hello\"><a class=\"anchor\" href=\"#hello\">#</a> Hello</h1>\n<p><span class=\"spoiler\" title=\"好奇心害死猫\">balabala</span></p>\n<details><summary>默认默认 这里是一段文字</summary><div>\n<p><ins>下划线</ins></p>\n</div></details>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_0\"> 红叉叉</label></li>\n</ul>\n<div class=\"note danger\">\n<p>危险 危险</p>\n</div>\n<p><span class=\"rainbow\">赤橙黄绿青蓝紫</span></p>\n<details><summary>内容 里面有图片题目</summary><div>\n<p><img data-src=\"/assets/photo-(1).jpg\" alt=\"photo-(1)\" /></p>\n<ol>\n<li class=\"quiz true\">编译时多态主要指运算符重载与函数重载，而运行时多态主要指虚函数。</li>\n<li class=\"quiz multi\">有基类  <code>SHAPE</code> ，派生类  <code>CIRCLE</code> ，声明如下变量： <figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SHAPE shape1<span class=\"token punctuation\">,</span><span class=\"token operator\">*</span>p1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>CIRCLE circle1<span class=\"token punctuation\">,</span><span class=\"token operator\">*</span>q1<span class=\"token punctuation\">;</span></pre></td></tr></table></figure>下列哪些项是 “派生类对象替换基类对象”。\n<ul class=\"options\">\n<li class=\"correct\"><code>p1=&amp;circle1;</code> </li>\n<li><code>q1=&amp;shape1;</code></li>\n<li class=\"correct\"><code>shape1=circle1;</code> </li>\n<li><code>circle1=shape1;</code></li>\n</ul>\n<blockquote>\n<ul class=\"options\">\n<li>✔️ 令基类对象的指针指向派生类对象</li>\n<li>❌ 派生类指针指向基类的引用</li>\n<li>✔️ 派生类对象给基类对象赋值</li>\n<li>❌ 基类对象给派生类对象赋值</li>\n</ul>\n</blockquote>\n</li>\n<li class=\"quiz\">下列叙述正确的是 <span class=\"gap\"></span> 。\n<ul class=\"options\">\n<li>虚函数只能定义成无参函数</li>\n<li>虚函数不能有返回值</li>\n<li>能定义虚构造函数</li>\n<li class=\"correct\">A、B、C 都不对</li>\n</ul>\n</li>\n<li class=\"quiz fill\">如定义  <code>int e=8; double f=6.4, g=8.9;</code> ，则表达式  <code>f+int (e/3*int (f+g)/2)%4</code>  的值为 <span class=\"gap\">9.4</span>。\n<blockquote>\n<p>注意运算顺序和数据类型<br />\n<span class=\"mistake\"> 8.4</span></p>\n</blockquote>\n</li>\n</ol>\n<p><div class=\"links\"><div class=\"item\" title=\"Jasper\" style=\"--block-color:#e9546b;\"><a href=\"https://crpdim.github.io/\" class=\"image\" data-background-image=\"/images/avatar.jpg\"></a>\n          <div class=\"info\">\n          <a href=\"https://crpdim.github.io/\" class=\"title\">你好呀</a>\n          <p class=\"desc\">Jasper's Blog</p>\n          </div></div></div></p>\n<p><div class=\"media-container\"><div class=\"player\" data-type=\"audio\" data-src='[{\"title\":\"列表1\",\"list\":[\"https://music.163.com/#/playlist?id=3072883579\",\"https://music.163.com/#/playlist?id=360062344\"]},{\"title\":\"列表2\",\"list\":[\"https://music.163.com/#/playlist?id=8168775473\"]}]'></div></div></p>\n<details class=\"info\"><summary>蓝色</summary><div>\n<div class=\"tab\" data-id=\"id2\" data-title=\"②号标签卡片 1\">\n<ul>\n<li>这里是卡片 1 的内容</li>\n</ul>\n</div>\n<div class=\"tab\" data-id=\"id2\" data-title=\"②号标签卡片 2\">\n<ul>\n<li>这里是卡片 2 的内容</li>\n</ul>\n</div>\n</div></details>\n</div></details>\n",
            "tags": [
                "blog模版"
            ]
        }
    ]
}